{"version":3,"sources":["interfaces/ModelInterfaces.ts","containers/LocalImportExport/LocalImportExport.tsx","containers/LocalImportExport/LocalImportExportViewModel.ts","containers/MenuBar/MenuBar.tsx","containers/Planner/CourseView/CourseView.tsx","models/CourseModel.ts","containers/Planner/CourseGroupView/CourseGroupView.tsx","containers/Planner/YearView/YearView.tsx","containers/Planner/components/ContextMenu/ContextMenuView.tsx","models/TermModel.ts","containers/SearchPanel/SearchPanelViewModel.tsx","containers/Planner/components/ContextMenu/ContextMenuViewModel.ts","containers/Planner/components/RegionSelect/RegionSelectView.tsx","containers/Planner/components/Dragging/DraggingView.tsx","containers/Planner/Planner.tsx","containers/Planner/PlannerViewModel.tsx","helpers/ConditionalTreeTraverser.ts","states/CourseState.ts","models/Validations/Validations.ts","models/CurriculumModel.ts","models/ProgramModel.ts","models/SpecialisationModel.ts","states/ProgressionState.ts","states/SearchDataState.ts","states/UserState.ts","contexts/ApplicationContext.ts","containers/SearchPanel/SearchPanelStyles.ts","containers/SearchPanel/Results/CourseResultView.tsx","containers/SearchPanel/Results/SpecialisationResultView.tsx","containers/ProgressionPlanner/CurriculumView/CurriculumElementsView.tsx","containers/ProgressionPlanner/CurriculumView/CurriculumContainerView.tsx","containers/ProgressionPlanner/ProgressionEntityView.tsx","containers/ProgressionPlanner/ProgressionPlanner.tsx","containers/ProgressionPlanner/ProgressionPlannerViewModel.ts","models/Filters/FilterModel.ts","models/Filters/Filters.ts","config/ResetButtonStyle.ts","containers/SearchPanel/Filter/FilterSection.tsx","containers/SearchPanel/Filter/FilterMenuView.tsx","containers/SearchPanel/Results/CourseResultCollectionView.tsx","containers/SearchPanel/SearchTab/CourseSearchTab.tsx","containers/SearchPanel/Results/ProgramResultView.tsx","containers/SearchPanel/Results/ProgramResultCollectionView.tsx","containers/SearchPanel/SearchTab/ProgramSearchTab.tsx","containers/SearchPanel/Results/SpecialisationResultCollectionView.tsx","containers/SearchPanel/SearchTab/SpecialisationSearchTab.tsx","containers/SearchPanel/SearchPanel.tsx","containers/AutoPlan/AutoPlannerView.tsx","containers/AutoPlan/AutoPlannerModel.ts","App.tsx","reportWebVitals.ts","index.tsx"],"names":["ProgressionStatus","ErrorCode","StudyLevel","ImportExportButton","styled","button","props","primary","css","ImportExportButtonContainer","div","LocalImportExport","localImportExportViewModel","inputRef","React","useRef","Fragment","onClick","export","current","click","ref","onChange","event","import","type","style","display","accept","SerializableVersionNumber","_versionNumber","this","imported","a","_version","console","log","LocalImportExportViewModel","userState","progressionState","courseState","_serializables","Map","set","data","FileSaver","saveAs","Blob","JSON","stringify","DateTime","now","toFormat","studyLevel","forEach","serializable","key","serialize","serializeToFile","json","parse","Promise","resolve","get","deserialize","then","catch","error","message","file","target","files","reader","FileReader","onload","ev","result","deserializeFromString","toString","value","readAsText","MenuBarView","Menu","MenuBar","observer","useState","undefined","studyLevelChangeAction","setStudyLevelChangeAction","pointing","Item","header","name","active","UNDERGRADUATE","setStudyLevel","POSTGRADUATE","RESEARCH","Modal","size","open","onClose","Header","Content","Actions","Button","negative","positive","Container","isSelected","isPrerequisiteOfCurrentDraggable","hasErrors","isDragging","isGhosting","horizontal","isRegionSelecting","SelectionCount","UnselectableText","p","tooltipStyle","fontSize","CourseView","CourseStatus","termOffering","allocatedPeriod","output","slice","sort","join","formatTermOffering","course","allocatedTerm","errorList","errors","missing","missingFormatted","regex","length","replace","i","push","formatErrors","useEffect","registerDraggableRef","draggableRef","deregisterDraggableRef","draggableId","code","index","droppableIndex","provided","snapshot","draggableProps","dragHandleProps","el","innerRef","prerequisitesOfCurrentDraggable","has","id","onCourseClick","onContextMenu","onCourseContextMenu","data-draggable","title","Tooltip","aria-label","aria-multiline","arrow","selectedCoursesCount","Title","h3","CourseList","isDraggingOver","isValidDroppable","isMultiSelectDragging","isPossibleTermOfCurrentDraggable","courseID","TermHeader","UocLabel","Label","getSelectedMap","memoizeOne","selectedCourses","reduce","previous","CourseGroupView","isPossibleTerm","term","currentDraggableProps","possibleTerms","filter","_term","equals","totalUoc","courses","map","creditPoints","b","color","content","droppableId","direction","droppableProps","draggingCourseId","prerequisiteCourseIds","placeholder","YearView","year","courseGroups","courseGroup","ContextMenu","contextMenuViewModel","Popup","basic","context","contextElement","isContextOpen","items","contextMenuItems","onItemClick","e","preventDefault","secondary","vertical","TermModel","makeAutoObservable","checkTermConstraints","Error","mappingName","parseInt","split","update","obj","tryGetTermNumber","serializedTerm","SearchPanelItem","CourseModel","contentTypeLabel","corequisites","description","effectiveDate","enrolmentRules","exclusion","facultyName","implementationYear","keywords","prerequisites","schoolName","urlMap","courseStatus","UNPLANNED","_errors","Set","ALLOCATED","clear","COMPLETED","PLANNED","add","delete","status","period","setPlanned","setCompleted","termModel","termFromSerializedData","setAllocated","ContextMenuViewModel","plannerViewModel","_plannerViewModel","_isContextOpen","_contextElement","_contextMenuItems","openContext","getBoundingClientRect","left","clientX","top","clientY","right","bottom","height","width","onWindowContextMenu","defaultPrevented","getContextMenuItems","find","selectedCourse","toggleSelection","makeObservable","observable","computed","state","element","areMultipleItems","menuItems","remove","icon","transaction","moveSelectedToRemoved","courseModel","setUnplanned","unselectAllCourses","includes","synchronizePlannerState","plan","moveSelectedToPlanned","complete","moveSelectedToCompleted","Object","values","RegionSelect","draggableBoxesRef","DragSelection","useSelectionContainer","onSelectionStart","setIsRegionSelecting","draggableItemsMap","entries","rect","onSelectionChange","box","draggableBox","boxesIntersect","toggleSelectionInGroup","onSelectionEnd","Dragging","onDragEnd","destination","source","reason","setCourseByDroppableId","getAllGroups","group","courseInGroup","spliceByGroupId","getCourseById","setIsDragging","clearCurrentDraggableProps","onBeforeCapture","onDragStart","initial","calculateDisplayableTerms","getMissingRequirementsWhenAssigningCourseToTerm","getFlattenedPrerequisiteList","children","YearPlanner","Planner","plannerState","window","addEventListener","onWindowKeyDown","onDragEnter","onDragExit","onMouseUp","removeEventListener","draggableItemsRef","registerDraggable","deregisterDraggable","ctrlKey","navigator","platform","metaKey","wasToggleInSelectionGroupKeyUsed","completedGroup","plannedGroup","yearGroups","yearGroup","Icon","link","undoTransaction","PlannerViewModel","_courseState","_plannerState","_selectedCourses","_MAX_BUFFER","_transactionBuffer","_previousState","_draggingCourseId","_currentDraggableProps","action","allocatedGroups","newCourses","indexOf","splice","A","B","groupId","isEqual","c1","c2","differences","iA","iB","indexOfAElemInB","findIndex","bCourse","deltas","getDifferences","previousGroup","pop","unshift","callback","startTransaction","args","apply","endTransaction","lastTransaction","shift","getCourseGroupById","fromMappingName","sourceDroppableId","destDroppableId","referenceCourses","targetCourses","expectedCourses","actualCourses","coursesToRemove","coursesToAdd","maxAllocatedYear","getMaxAllocatedYear","displayableTerms","Date","getFullYear","uniqueYears","getMappingName","getFullName","newPlannerState","synchronizeCourseList","termCourseMap","plannedCourses","completedCourses","start","deleteCount","conditionalTreeTraverser","treeNode","fnIsLeafValid","invalidations","or","childNode","and","isAndConditionalTree","CourseState","_userState","validations","getTermName","addError","COURSE_NOT_OFFERED_IN_SELECTED_TERM","getMissingPrerequisitesBeforeTerm","PREREQUISITE_REQUIREMENT_NOT_MET","getMissingPrerequisitesPlanned","PREREQUISITES_NOT_PLANNED","conflictingExclusionCourses","exclusionCourseCode","exclusionCourse","EXCLUSION_COURSE_CONFLICT","coursesMapById","coursesMapByActiveStatus","_isUpdated","reaction","_updateStudyLevel","fireImmediately","registerStudyLevelUpdateActionCallback","axios","response","_resetCourseMap","courseObj","addCourse","_loadAllCourses","mapping","courseList","allCourses","concat","allocatedCourses","uniqueTerms","keys","maxYear","courseStatusEnum","isNaN","Number","runValidations","_course","clearErrors","fnValidate","prerequisiteTree","courseCode","isBefore","resp","courseIsOffered","activeCourses","serializedCourseState","when","resetHard","serializedCourse","CurriculumContainer","elements","containers","order","uuidv4","CurriculumElement","itemCode","url","toLowerCase","parseCurriculumContainers","childrenData","rootContainerList","childContainerList","elementList","relationships","parseCurriculumElements","container","relationData","relationshipList","relationshipObj","ProgramModel","academicItemType","additionalInfo","structureSummary","curriculumStructure","intakePeriod","programConstraints","progressionStatus","program","SpecialisationModel","specialisation","ProgressionState","_programMapById","_specialisationMapById","loadAllPrograms","loadAllSpecialisations","programObj","addProgram","specialisationObj","addSpecialisation","allPrograms","allSpecialisations","plannedPrograms","plannedSpecialisations","programs","programModel","specialisations","specialisationModel","serializedProgressionState","serializedProgram","getProgramById","serializedSpecialisation","getSpecialisationById","SearchDataState","_progressionState","stringToStudyLevelMap","str","_studyLevel","_studyLevelUpdateActionCallbacks","studyLevelPromises","all","isUpdated","updateAction","serializedUserState","level","searchDataState","ApplicationContext","createContext","ResultItem","ResultItemHeader","ResultItemContent","ResultItemExtra","Extra","ResultCollection","Group","ResultsPagination","Pagination","ResultsColumn","Grid","Column","CourseResultView","showOptions","setShowOptions","onMouseOver","onMouseLeave","Description","newWindow","opener","openInNewTab","className","SpecialisationResultView","onMouseEnter","CurriculumElementsView","applicationContext","useContext","curriculumElements","divided","isCourse","isSpecialisation","CurriculumAccordionCreditPoints","CurriculumAccordionTitle","Accordion","CurriculumDescriptionDiv","CurriculumExpandCollapseLink","CurriculumContent","CurriculumContainerView","getCreditPointsView","uocOfChildren","progressionPlannerViewModel","calculateUocOfChildren","curriculumContainer","exclusive","panels","isContainerActive","sanitizeHtml","href","toggleAllContainers","isAnySubContainerActive","entityId","onTitleClick","toggleContainer","ProgressionEntityTitle","ProgressionEntityView","entity","fluid","ProgressionContainer","ProgresionPlanner","plannedProgressionEntities","ProgressionPlannerViewModel","_progressionPlannerState","_displayableContainerPanels","getUniqueUocOfCurriculumContainer","allChildren","containerId","rootContainer","setAllContainersInactive","setAllContainersActive","FilterModel","fnGetTargetValue","_possibleValues","_selectedValues","filterResultMapping","initializeFilter","allSearchData","flat","applyFilter","searchResults","results","filterValue","isNumerical","possibleFilterValue","filterElementName","numMatchingRecords","SearchPanelViewModel","queryText","isLoading","resultsPerPage","isInputActive","searchFilters","courseFilters","programFilters","specialisationFilters","courseSearchResults","programSearchResults","specialisationSearchResults","activeItem","COURSES","setActiveItem","item","courseSearchData","setIsLoading","filters","getCourseFilters","programSearchData","getProgramFilters","specialisationSearchData","getSpecialisationFilters","autorun","searchCourses","searchPrograms","searchSpecialisations","runInAction","ResetButtonStyle","backgroundColor","border","padding","textDecoration","margin","cursor","FilterSection","expandedFilters","setExpandedFilters","filterState","getFilterState","newExpandedFilters","Form","grouped","filterElementState","Checkbox","label","checked","toggleValue","FilterMenuView","resetValue","as","CourseResultCollectionView","CourseSearchTab","activePageNumber","setActivePageNumber","columns","Row","searchPanelViewModel","Math","min","totalPages","ceil","onPageChange","activePage","ProgramResultView","ProgramResultCollectionView","ProgramSearchTab","SpecialisationResultCollectionView","SpecialisationSearchTab","ResultsSubtextContainer","FoundResults","h4","SearchPanel","getNumResults","numResults","PROGRAMS","SPECIALISATIONS","Input","loading","setQueryText","setInputActive","shouldShowPanel","marginRight","Dropdown","text","selection","options","setResultsPerPage","AutoPlanButton","AutoPlanner","autoPlannerViewModel","autoPlan","AutoPlannerViewModel","canAllocateCourses","listYearsToTryAllocate","getYearsToTryAllocate","listTermsToTryAllocate","coursesToBeAllocated","hasChanged","counter","termAllocatedFlag","j","canAssignToTerm","termHasSpaceToAllocate","termHasLessThanThreeCourses","termIsDisabled","assignCourseToTerm","dictKey","list","App","localImportExportModel","Provider","defaultSize","ProgressionPlanner","paddingLeft","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d156219c.chunk.js","sourcesContent":["export interface ICurriculumContainer {\r\n    id: string;\r\n    title: string;\r\n    description: string;\r\n    creditPoints: number;\r\n    elements: ICurriculumElement[];\r\n    containers: ICurriculumContainer[];\r\n    order: number;\r\n}\r\n\r\nexport interface ICurriculumElement {\r\n    name: string;\r\n    description: string;\r\n    type: string;\r\n    creditPoints: number;\r\n    itemCode: string;\r\n    url: string;\r\n    order: number;\r\n    isCourse: () => boolean;\r\n    isSpecialisation: () => boolean;\r\n}\r\n\r\nexport interface IOrConditionalTree {\r\n    or: ConditionalTree[]\r\n}\r\nexport interface IAndConditionalTree {\r\n    and: ConditionalTree[]\r\n}\r\n\r\nexport const isOrConditionalTree = (obj: any): obj is IOrConditionalTree => {\r\n    return obj && obj.or\r\n}\r\n\r\nexport const isAndConditionalTree = (obj: any): obj is IAndConditionalTree => {\r\n    return obj && obj.and\r\n}\r\n\r\nexport type ConditionalTree = IOrConditionalTree | IAndConditionalTree | string\r\n\r\nexport interface ICourse {\r\n    id: string;\r\n    code: string;\r\n    contentTypeLabel: string;\r\n    corequisites: string[];\r\n    creditPoints: number;\r\n    description: string;\r\n    effectiveDate: Date; // Form (new Date('YYYY-MM-DD'));\r\n    enrolmentRules: string[];\r\n    exclusion: string[];\r\n    facultyName: string;\r\n    implementationYear: number;\r\n    keywords: string[];\r\n    prerequisites: ConditionalTree;\r\n    schoolName: string;\r\n    studyLevel: string;\r\n    termOffering: string[];\r\n    title: string;\r\n    urlMap: string;\r\n}\r\n\r\nexport interface IProgram {\r\n    id: string;\r\n    code: string;\r\n    title: string;\r\n    description: string;\r\n    academicItemType: string;\r\n    creditPoints: number;\r\n    curriculumStructure: Array<ICurriculumContainer>;\r\n    facultyName: string;\r\n    schoolName: string;\r\n    additionalInfo: string;\r\n    implementationYear: number;\r\n    intakePeriod: Array<string>;\r\n    programConstraints: Array<any>;\r\n    studyLevel: string;\r\n}\r\n\r\nexport interface ISpecialisation {\r\n    id: string;\r\n    code: string;\r\n    title: string;\r\n    description: string;\r\n    academicItemType: string;\r\n    creditPoints: number;\r\n    curriculumStructure: Array<ICurriculumContainer>;\r\n    facultyName: string;\r\n    schoolName: string;\r\n    implementationYear: number;\r\n    keywords: string[];\r\n    studyLevel: string;\r\n    urlMap: string;\r\n}\r\n\r\nexport interface IProgressionEntity {\r\n    id: string;\r\n    code: string;\r\n    title: string;\r\n    description: string;\r\n    academicItemType: string;\r\n    creditPoints: number;\r\n    structureSummary: string,\r\n    curriculumStructure: Array<ICurriculumContainer>;\r\n    facultyName: string;\r\n    schoolName: string;\r\n    progressionStatus: ProgressionStatus,\r\n    setPlanned: () => void,\r\n    setUnplanned: () => void,\r\n}\r\n\r\nexport enum ProgressionStatus {\r\n    UNPLANNED,\r\n    PLANNED,\r\n}\r\n\r\nexport interface IValidatableEntity {\r\n    addError: (error: IError) => void\r\n    removeError: (error: IError) => void\r\n    hasErrors: () => boolean\r\n    clearErrors: () => void\r\n    errors: IError[]\r\n}\r\n\r\nexport enum ErrorCode {\r\n    UNKNOWN,\r\n    COURSE_NOT_OFFERED_IN_SELECTED_TERM,\r\n    PREREQUISITES_NOT_PLANNED,  \r\n    PREREQUISITE_REQUIREMENT_NOT_MET,\r\n    COREQUISITE_REQUIREMENT_NOT_MET,\r\n    EXCLUSION_COURSE_CONFLICT,\r\n}\r\n\r\nexport interface IError {\r\n    code: ErrorCode,\r\n    message: string,\r\n    missing: string,\r\n}\r\n\r\nexport enum StudyLevel {\r\n    UNDERGRADUATE=\"undergraduate\",\r\n    POSTGRADUATE=\"postgraduate\",\r\n    RESEARCH=\"research\",\r\n}\r\n","import React from 'react';\nimport { LocalImportExportViewModel } from \"./LocalImportExportViewModel\"\nimport styled, { css } from \"styled-components\"\n\nconst ImportExportButton = styled.button`\n  background: transparent;\n  border-radius: 4px;\n  border: 2px solid darkgrey;\n  color: black;\n  margin: 4px 2px;\n  padding: 15px 32px;\n  font-size: 20px;\n  display: inline-block;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n\n  transition-duration: 0.2s;\n  :hover {\n    background: #f2f2f2;\n  }\n\n  -webkit-user-select: none;  /* Chrome all / Safari all */\n  -moz-user-select: none;     /* Firefox all */\n  -ms-user-select: none;      /* IE 10+ */\n  user-select: none;          /* Likely future */ \n\n  ${props => props.primary && css`\n    background: darkgrey;\n\n    :hover {\n      background: lightgrey;\n    }\n  `}\n`;\n\nconst ImportExportButtonContainer = styled.div`\n  width: 48%;\n  display: inline;\n  background: transparent;\n  float: left;\n  margin: 0% 1%;\n`;\n\nconst LocalImportExport = ({ localImportExportViewModel }: { [key: string]: LocalImportExportViewModel }) => {\n  const inputRef = React.useRef<HTMLInputElement>(null);\n\n  return (\n    <React.Fragment>\n      <ImportExportButtonContainer>\n        <ImportExportButton primary onClick={() => { localImportExportViewModel.export() }}>\n          Export\n        </ImportExportButton>\n      </ImportExportButtonContainer>\n      <ImportExportButtonContainer>\n        <ImportExportButton onClick={() => { inputRef.current?.click() }}>\n          Import\n        </ImportExportButton>\n        <input\n          ref={inputRef}\n          onChange={(event) => localImportExportViewModel.import(event)}\n          type=\"file\"\n          style={{ display: \"none\" }}\n          accept=\"application/JSON\"\n        />\n      </ImportExportButtonContainer>\n    </React.Fragment >\n  )\n};\n\nexport default LocalImportExport;","import { CourseState } from \"../../states/CourseState\"\nimport { ProgressionState } from \"../../states/ProgressionState\"\nimport React from \"react\"\nimport { UserState } from \"../../states/UserState\"\nimport { ISerializableEntity, TermtanglesSerialized } from \"../../interfaces/SerializableInterfaces\"\nimport { DateTime } from \"luxon\"\nimport FileSaver from \"file-saver\"\n\nexport class SerializableVersionNumber implements ISerializableEntity {\n  private _versionNumber: number = 1;\n\n  serialize(): Object {\n    return this._versionNumber;\n  }\n\n  async deserialize(imported: TermtanglesSerialized): Promise<void> {\n    if (!imported._version) {\n      throw \"ERROR: Version not included.\";\n    }\n\n    console.log(\"Termtangle data version: \" + imported._version);\n  }\n}\n\nexport class LocalImportExportViewModel {\n  private _serializables = new Map<string, ISerializableEntity>();\n\n  constructor (userState: UserState, progressionState: ProgressionState, courseState: CourseState) {\n    this._serializables.set(\"_version\", new SerializableVersionNumber());\n    this._serializables.set(\"userState\", userState);\n    this._serializables.set(\"progressionState\", progressionState);\n    this._serializables.set(\"courseState\", courseState);\n  }\n\n  serializeToFile(data: TermtanglesSerialized) {\n    FileSaver.saveAs(\n      new Blob([JSON.stringify(data)], { type: \"application/json;charset=utf-8\" }),\n      `termtangles_${DateTime.now().toFormat(\"yyyyMMdd_HHmmssSSS\")}.json`,\n    );\n  }\n\n  export() {\n    const data: TermtanglesSerialized = {\n      _version: 0,\n      userState: {studyLevel: \"\"}\n    };\n    this._serializables.forEach((serializable, key) => {\n      data[key] = serializable.serialize();\n    });\n    this.serializeToFile(data);\n  }\n\n  async deserializeFromString (data: string) {\n    try {\n      const json: TermtanglesSerialized = JSON.parse(data);\n\n      return Promise.resolve(\n        this._serializables.get(\"_version\")?.deserialize(json).then(() => \n          this._serializables.get(\"userState\")?.deserialize(json).then(() => \n            Promise.resolve([\n              this._serializables.get(\"progressionState\")?.deserialize(json),\n              this._serializables.get(\"courseState\")?.deserialize(json),\n            ])\n          )\n        )\n      ).catch((error) => { console.error(error) })\n    } catch (e) {\n      console.error(`ERROR: Invalid JSON (${e.message})`);\n    }\n  }\n\n  import (event: React.ChangeEvent<HTMLInputElement>) {\n    const file: Blob = event.target.files![0];\n    \n    let reader = new FileReader();\n    reader.onload = async (ev) => {\n      if (ev.target?.result) {\n        await this.deserializeFromString(ev.target.result.toString());\n        event.target.value = \"\";\n      }\n    }\n    reader.readAsText(file);\n  }\n}\n","import styled from 'styled-components'\nimport { Observer, observer } from 'mobx-react';\nimport React, { useState } from 'react';\nimport { Button, Menu, Modal } from 'semantic-ui-react';\nimport { StudyLevel } from '../../interfaces/ModelInterfaces';\nimport { UserState } from '../../states/UserState';\n\nexport interface IMenuBarProps {\n  userState: UserState\n}\n\nconst MenuBarView = styled(Menu)`\n  &&{\n    margin: auto 0 auto 0;\n  }\n`\n\nexport const MenuBar = observer((props: IMenuBarProps) => {\n  const [studyLevelChangeAction, setStudyLevelChangeAction] = useState<(() => void) | undefined>(undefined)\n  return <Observer>\n    {() => {\n      return (\n        <React.Fragment>\n          <MenuBarView pointing>\n            <Menu.Item header>Termtangles</Menu.Item>\n            <Menu.Item\n              name={\"Undergraduate\"}\n              active={props.userState.studyLevel === StudyLevel.UNDERGRADUATE}\n              onClick={\n                () => props.userState.studyLevel !== StudyLevel.UNDERGRADUATE\n                  ? setStudyLevelChangeAction(() => () => props.userState.setStudyLevel(StudyLevel.UNDERGRADUATE))\n                  : {}\n              }\n            />\n            <Menu.Item\n              name={\"Postgraduate\"}\n              active={props.userState.studyLevel === StudyLevel.POSTGRADUATE}\n              onClick={\n                () => props.userState.studyLevel !== StudyLevel.POSTGRADUATE\n                  ? setStudyLevelChangeAction(() => () => props.userState.setStudyLevel(StudyLevel.POSTGRADUATE))\n                  : {}\n              }\n            />\n            <Menu.Item\n              name={\"Research\"}\n              active={props.userState.studyLevel === StudyLevel.RESEARCH}\n              onClick={\n                () => props.userState.studyLevel !== StudyLevel.RESEARCH\n                  ? setStudyLevelChangeAction(() => () => props.userState.setStudyLevel(StudyLevel.RESEARCH))\n                  : {}\n              }\n            />\n          </MenuBarView>\n\n          <Modal\n            size='small'\n            open={studyLevelChangeAction !== undefined}\n            onClose={() => setStudyLevelChangeAction(undefined)}\n          >\n            <Modal.Header>Study Level Change</Modal.Header>\n            <Modal.Content>\n              <p>Changing study level will reset all current progress. Do you want to continue?</p>\n            </Modal.Content>\n            <Modal.Actions>\n              <Button negative onClick={() => setStudyLevelChangeAction(undefined)}>\n                No\n              </Button>\n              <Button positive onClick={() => {\n                if (studyLevelChangeAction) {\n                  studyLevelChangeAction()\n                }\n                setStudyLevelChangeAction(undefined)\n              }}>\n                Yes\n              </Button>\n            </Modal.Actions>\n          </Modal>\n\n        </React.Fragment>\n      )\n    }}\n  </Observer>\n})\n","import styled from 'styled-components'\nimport { CourseModel } from '../../../models/CourseModel';\nimport { Draggable } from 'react-beautiful-dnd'\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { IError } from '../../../interfaces/ModelInterfaces';\nimport { TermModel } from '../../../models/TermModel';\nimport React from 'react';\nimport { useEffect } from 'react';\n\nconst getBackgroundColor = (props) => {\n  return (\n    props.isPrerequisiteOfCurrentDraggable\n      ? '#c5eafc'\n      : props.hasErrors()\n        ? '#f5bfc8'\n        : props.isDragging\n          ? 'lightgrey'\n          : 'white'\n  )\n}\n\nconst Container = styled.div`\n  border: ${(props) =>\n    props.isSelected\n      ? \"2px dashed royalblue\"\n      : \"2px solid lightgrey\"\n  };\n  border-radius: 8px;\n  padding: 8px;\n  margin: 0px 2px 8px 2px;\n  background-color: ${getBackgroundColor};\n  ${(props) =>\n    props.isDragging\n      ? `box-shadow: 2px 2px 1px lightgrey;`\n      : ''\n  }\n  \n  ${(props) =>\n    props.isGhosting\n      ? 'opacity: 0.9; color: darkgrey;'\n      : ''\n  }\n\n  /* needed for SelectionCount */\n  position: relative;\n\n  ${props => props.horizontal ? \"\" : \"flex-grow: 1;\"}\n  height: fit-content;\n  max-width: 350px;\n\n  &:active {\n    outline: none;\n    ${props => props.isRegionSelecting ? \"\" : \"border: 2px inset lightgrey;\"}\n  }\n\n\n  -webkit-user-select: none;  /* Chrome all / Safari all */\n  -moz-user-select: none;     /* Firefox all */\n  -ms-user-select: none;      /* IE 10+ */\n  user-select: none;          /* Likely future */\n`\nconst SelectionCount = styled.div`\n  right: -20px;\n  top: -20px;\n  color: white;\n  background: royalblue;\n  border-radius: 50%;\n  height: 35px;\n  width: 35px;\n  line-height: 35px;\n  position: absolute;\n  text-align: center;\n  font-size: 15px;\n  \n`;\n\nconst UnselectableText = styled.p`\n  -webkit-user-select: none;  /* Chrome all / Safari all */\n  -moz-user-select: none;     /* Firefox all */\n  -ms-user-select: none;      /* IE 10+ */\n  user-select: none;          /* Likely future */      \n`\n\nconst tooltipStyle = {\n  fontSize: 13,\n}\n\ninterface ICourseViewProps {\n  droppableIndex: number\n  course: CourseModel\n  prerequisitesOfCurrentDraggable: Set<string>\n  horizontal?: boolean\n  isSelected: boolean\n  isGhosting: boolean\n\n  registerDraggableRef: (courseModel: CourseModel, ref: React.MutableRefObject<any>) => void\n  deregisterDraggableRef: (courseModel: CourseModel) => void\n\n  selectedCoursesCount: number;\n  onCourseClick: (course: CourseModel, event: MouseEvent) => void;\n\n  onCourseContextMenu: (course: CourseModel, event: MouseEvent) => void;\n\n  isRegionSelecting: boolean;\n}\n\nconst CourseView = (props: ICourseViewProps) => {\n  let termOffering = formatTermOffering(props.course.termOffering, props.course.allocatedTerm);\n  let errorList: string[] = formatErrors(props.course.errors);\n\n  useEffect(() => {\n    props.registerDraggableRef(props.course, draggableRef);\n\n    return (() => props.deregisterDraggableRef(props.course));\n  })\n\n  // Drag region selection\n  const draggableRef = React.useRef<HTMLDivElement | null | undefined>();\n\n  return (\n    <Draggable draggableId={props.course.code} index={props.droppableIndex} >\n      {((provided, snapshot) => {\n        return (\n          <Container\n            horizontal={props.horizontal}\n            {...provided.draggableProps}\n            {...provided.dragHandleProps}\n            ref={(el) => {\n              provided.innerRef(el);\n              draggableRef.current = el;\n            }}\n            isDragging={snapshot.isDragging}\n            isPrerequisiteOfCurrentDraggable={props.prerequisitesOfCurrentDraggable.has(props.course.id)}\n            hasErrors={() => props.course.hasErrors()}\n            isSelected={props.isSelected}\n            onClick={(event: MouseEvent) => props.onCourseClick(props.course, event)}\n            isGhosting={props.isGhosting}\n            onContextMenu={(event: MouseEvent) => props.onCourseContextMenu(props.course, event)}\n            isRegionSelecting={props.isRegionSelecting}\n            // https://github.com/AirLabsTeam/react-drag-to-select#working-with-draggable-elements\n            // Tell region select this is a draggable.\n            data-draggable={true}\n          >\n\n            {!props.isRegionSelecting ? (\n              <Tooltip title={\n                <span>\n                  <UnselectableText style={tooltipStyle}>{termOffering}</UnselectableText>\n                  <UnselectableText style={tooltipStyle}>{errorList[0]}</UnselectableText>\n                  <UnselectableText style={tooltipStyle}>{errorList[1]}</UnselectableText>\n                </span>}\n                aria-label=\"add\" aria-multiline=\"true\" arrow={true}\n              >\n                <UnselectableText> {props.course.code} - {props.course.title}</UnselectableText>\n              </Tooltip>\n            ) : <UnselectableText> {props.course.code} - {props.course.title}</UnselectableText>}\n\n            {snapshot.isDragging && props.selectedCoursesCount > 1 ? (\n              <SelectionCount>{props.selectedCoursesCount}</SelectionCount>\n            ) : undefined}\n          </Container>\n        )\n      })}\n    </Draggable>\n  )\n}\n\nfunction formatErrors(errors: IError[]): string[] {\n  let output: string[] = [];\n  let missing: string[] = [];\n  let missingFormatted: string[] = [];\n  const regex = /<br\\/>/ig;\n\n  if (errors.length === 0) {\n    return [\"\"];\n  }\n\n  if (errors.length === 1) {\n    return [errors[0].message.replace(regex, \"\"), `${errors[0].missing} `];\n  }\n\n  for (let i = 0; i < errors.length; i++) {\n    output.push(errors[i].message.replace(regex, \"\"));\n    missing.push(errors[i].missing);\n  }\n\n  // Format missing arr for empty elements and remove from array before joining\n  for (let i = 0; i < errors.length; i++) {\n    if (missing[i] !== \"\") {\n      missingFormatted.push(missing[i]);\n    }\n  }\n\n  return [output.join(\" & \"), missingFormatted.join(\" & \")];\n}\n\nfunction formatTermOffering(termOffering: string[], allocatedPeriod: TermModel | undefined) {\n  termOffering = termOffering.slice().sort();\n  let output: string = termOffering.join(\", \");\n\n  output = `Term Offerings: ${output} `;\n\n  return output;\n}\n\nexport default CourseView\n","import { makeAutoObservable } from \"mobx\";\nimport { TermModel } from \"./TermModel\";\nimport { SerializedCourse, ISerializableEntity } from \"../interfaces/SerializableInterfaces\"\nimport { ICourse, ConditionalTree, IValidatableEntity, IError } from '../interfaces/ModelInterfaces';\n\nexport enum CourseStatus {\n  UNPLANNED,\n  PLANNED,\n  ALLOCATED,\n  COMPLETED,\n}\n\nexport class CourseModel implements ICourse, IValidatableEntity, ISerializableEntity {\n  allocatedTerm: TermModel | undefined = undefined;\n  public readonly id: string\n  public courseStatus: CourseStatus = CourseStatus.UNPLANNED // Default unplanned\n\n  private _errors: Set<IError> = new Set<IError>()\n\n  constructor(\n    public readonly code: string,\n    public readonly contentTypeLabel: string,\n    public readonly corequisites: string[],\n    public readonly creditPoints: number,\n    public readonly description: string,\n    public readonly effectiveDate: Date, // Form (new Date('YYYY-MM-DD'));\n    public readonly enrolmentRules: string[],\n    public readonly exclusion: string[],\n    public readonly facultyName: string,\n    public readonly implementationYear: number,\n    public readonly keywords: string[],\n    public readonly prerequisites: ConditionalTree,\n    public readonly schoolName: string,\n    public readonly studyLevel: string,\n    public readonly termOffering: string[],\n    public readonly title: string,\n    public readonly urlMap: string,\n  ) {\n    this.id = code;\n    makeAutoObservable(this)\n  }\n\n  setAllocated(term: TermModel) {\n    this.courseStatus = CourseStatus.ALLOCATED\n    this.allocatedTerm = term\n  }\n\n  setUnplanned() {\n    this._errors.clear()\n    this.courseStatus = CourseStatus.UNPLANNED\n    this.allocatedTerm = undefined\n  }\n\n  setCompleted() {\n    this._errors.clear()\n    this.courseStatus = CourseStatus.COMPLETED\n    this.allocatedTerm = undefined\n  }\n\n  setPlanned() {\n    this.courseStatus = CourseStatus.PLANNED\n    this.allocatedTerm = undefined\n  }\n\n  //#region IValidatableEntity\n  addError(error: IError) {\n    this._errors.add(error)\n  }\n\n  removeError (error: IError) {\n    this._errors.delete(error)\n  }\n\n  hasErrors(): boolean {\n    return this._errors.size > 0\n  }\n\n  clearErrors() {\n    this._errors.clear()\n  }\n\n  get errors(): IError[] {\n    return [...this._errors]\n  }\n  //#endregion\n\n  serialize(): SerializedCourse {\n    if (this.courseStatus !== CourseStatus.ALLOCATED) {\n      return {\n        id: this.id,\n        status: CourseStatus[this.courseStatus],\n      }\n    } else {\n      return {\n        id: this.id,\n        status: CourseStatus[this.courseStatus],\n        period: this.allocatedTerm?.serialize(),\n      }\n    }\n  }\n\n  async deserialize(course: SerializedCourse) {\n    if (course.id !== this.id) {\n      console.error(`ERROR: This course is not ${course.id} (is: ${this.id})`);\n      return;\n    }\n\n    switch(course.status) {\n      case (CourseStatus[CourseStatus.PLANNED]): {\n        this.setPlanned();\n        break;\n      }\n      case (CourseStatus[CourseStatus.COMPLETED]): {\n        this.setCompleted();\n        break;\n      }\n      case (CourseStatus[CourseStatus.ALLOCATED]): {\n        if (course.period) {\n          try {\n            let termModel = TermModel.termFromSerializedData(course.period);\n            this.setAllocated(termModel);\n          } catch (e) {\n            console.error(`ERROR: invalid term period passed in ${course.period} (${e.message})`);\n          }\n          \n        } else {\n          console.error(`ERROR: Allocated course status with no period ${course.id}`);\n        }\n        break;\n      }\n      default: {\n        console.error(`ERROR: ${course.status} is not a valid status`);\n      }\n    }\n  }\n\n  toString() {\n    return `[COURSE_${this.id}] ${this.code} - ${this.title}`;\n  }\n}\n\n// export function loadCourseByCode(courseCode: string) {\n//   return db.collection(\"courses\")\n//     .doc(courseCode)!\n//     .withConverter(courseConverter)\n//     .get().then((doc) => {\n//       if (doc.exists) {\n//         var course = doc.data()!;\n\n//         return course;\n//       } else {\n//         console.log(\"No such document!\");\n//       }\n//     }).catch((error) => {\n//       console.log(\"Error getting document:\", error);\n//       throw new Error();\n//     });\n// }\n\n// let courseConverter = {\n//   toFirestore: function (course) {\n//     return {\n//       name: course.code,\n//     };\n//   },\n//   fromFirestore: function (snapshot, options) {\n//     const data = snapshot.data(options);\n//     let effectiveDate = new Date(data.effectiveDate);\n\n//     return new CourseModel(\n//       data.code,\n//       data.contentTypeLabel,\n//       data.corequisites,\n//       Number(data.creditPoints),\n//       data.description,\n//       effectiveDate,\n//       data.enrolmentRules,\n//       data.exclusion,\n//       data.facultyName,\n//       Number(data.implementationYear),\n//       data.keywords,\n//       data.prerequisites,\n//       data.schoolName,\n//       data.studyLevel,\n//       data.termOffering,\n//       data.title,\n//       data.urlMap,\n//     );\n//   }\n// };","import { Droppable } from 'react-beautiful-dnd';\nimport { Label } from 'semantic-ui-react';\nimport styled from 'styled-components'\nimport { CourseModel } from '../../../models/CourseModel';\nimport { TermModel } from '../../../models/TermModel';\nimport CourseView from '../CourseView/CourseView';\nimport { ICurrentDraggableProps } from '../PlannerViewModel';\nimport memoizeOne from \"memoize-one\"\n\nconst Container = styled.div`\n  margin: 8px;\n  border: 1px solid lightgrey;\n  border-radius:2px;\n\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  ${props => !props.horizontal ? \"max-width: 350px\" : \"\"};\n  ${props => props.title === \"Planned\" ? \"min-width: 350px\" : \"\"};\n  -webkit-user-select: none;  /* Chrome all / Safari all */\n  -moz-user-select: none;     /* Firefox all */\n  -ms-user-select: none;      /* IE 10+ */\n  user-select: none;          /* Likely future */ \n`\n\nconst Title = styled.h3`\n  padding: 6px;\n  margin: 0 0;\n  display: flex;\n  width: 200px;\n`;\n\nconst CourseList = styled.div`\n  padding: 6px;\n  min-height: 100px;\n  transition: background-color 0.2s ease;\n  background-color: ${props =>\n  (props.isDraggingOver\n    ? props.isValidDroppable || props.isMultiSelectDragging\n      ? '#8debb7'\n      : '#ff99b0'\n    : props.isPossibleTermOfCurrentDraggable\n      ? '#cafae0'\n      : (props.courseID === \"completed\")\n        ? '#edf2f4'\n        : (props.courseID === \"planned\")\n          ? '#edf2f4'\n          : '#edf2f4'\n  )\n  };\n  flex-grow: 1;\n  display: flex;\n  flex-direction: ${props => props.horizontal ? \"row\" : \"column\"};\n  flex-flow: row ${props => props.horizontal ? \"wrap\" : \"nowrap\"};\n  align-content: flex-start;\n  max-width: inherit;\n`;\n\n\n\nconst TermHeader = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n`\n\nconst UocLabel = styled(Label)`\n  && {\n    margin: auto 0 auto 0;\n    height: fit-content;\n    vertical-align: middle;\n    white-space: nowrap;\n  } \n`\n\ninterface ITermViewProps {\n  id: string\n  title: string\n  courses: CourseModel[]\n  term: TermModel | null\n  currentDraggableProps: ICurrentDraggableProps\n  horizontal?: boolean\n\n  registerDraggableRef: (courseModel: CourseModel, ref: React.MutableRefObject<any>) => void\n  deregisterDraggableRef: (courseModel: CourseModel) => void\n\n  selectedCourses: CourseModel[];\n  draggingCourseId?: string;\n  onCourseClick: (course: CourseModel, event: MouseEvent) => void;\n\n  onCourseContextMenu: (course: CourseModel, event: MouseEvent) => void;\n\n  isRegionSelecting: boolean;\n}\n\nconst getSelectedMap = memoizeOne((selectedCourses: CourseModel[]) =>\n  selectedCourses.reduce((previous, current) => {\n    previous[current.id] = true;\n    return previous;\n  }, {}),\n);\n\nconst CourseGroupView = (props: ITermViewProps) => {\n  const isPossibleTerm = (term: TermModel | null): boolean => {\n    return props.currentDraggableProps.possibleTerms.filter(_term => _term.equals(term)).length > 0\n  }\n  const totalUoc = props.courses.map(course => course.creditPoints).reduce((a, b) => a + b, 0)\n\n  return (\n    <Container horizontal={props.horizontal} title={props.title}>\n      <TermHeader>\n        <Title>{props.title}</Title>\n        {\n          props.term\n            ? <UocLabel\n              color={(totalUoc === 18 || props.courses.length === 3)\n                ? \"green\"\n                : totalUoc < 18\n                  ? \"orange\"\n                  : \"yellow\"\n              }\n              content={`${totalUoc} UOC`}\n              size={\"small\"}\n            />\n            : <></>\n        }\n      </TermHeader>\n      <Droppable\n        droppableId={props.id}\n        direction={props.horizontal ? 'horizontal' : 'vertical'}\n      >\n        {\n          (provided, snapshot) => (\n            <CourseList\n              horizontal\n              {...provided.droppableProps}\n              ref={provided.innerRef}\n              isDraggingOver={snapshot.isDraggingOver}\n              courseID={provided.droppableProps['data-rbd-droppable-id']}\n              isPossibleTermOfCurrentDraggable={isPossibleTerm(props.term)}\n              isValidDroppable={props.term === null || isPossibleTerm(props.term)}\n              isMultiSelectDragging={props.selectedCourses.length > 1}\n            >\n              {\n                props.courses ? props.courses.map((course, index) => {\n                  const isSelected: boolean = !!getSelectedMap(props.selectedCourses)[course.id]\n                  const isGhosting: boolean = isSelected && !!props.draggingCourseId && props.draggingCourseId !== course.id;\n                  return (\n                    <CourseView\n                      horizontal={props.horizontal}\n                      key={course.code}\n                      course={course}\n                      droppableIndex={index}\n                      prerequisitesOfCurrentDraggable={props.currentDraggableProps.prerequisiteCourseIds}\n                      isSelected={isSelected}\n                      isGhosting={isGhosting}\n                      registerDraggableRef={props.registerDraggableRef}\n                      deregisterDraggableRef={props.deregisterDraggableRef}\n                      selectedCoursesCount={props.selectedCourses.length}\n                      onCourseClick={props.onCourseClick}\n                      onCourseContextMenu={props.onCourseContextMenu}\n                      isRegionSelecting={props.isRegionSelecting}\n                    />\n                  )\n                })\n                  : undefined\n              }\n              {provided.placeholder}\n            </CourseList>\n          )\n        }\n      </Droppable>\n    </Container>\n  )\n};\nexport default CourseGroupView\n","import styled from 'styled-components';\nimport { CourseModel } from '../../../models/CourseModel';\nimport CourseGroupView from '../CourseGroupView/CourseGroupView';\nimport { ICourseGroup, ICurrentDraggableProps } from '../PlannerViewModel';\n\nconst Container = styled.div`\n    margin: 8px;\n    border: 1px solid lightgrey;\n    border-radius:2px;\n    width: 250px;\n    -webkit-user-select: none;  /* Chrome all / Safari all */\n    -moz-user-select: none;     /* Firefox all */\n    -ms-user-select: none;      /* IE 10+ */\n    user-select: none;          /* Likely future */ \n`\n\nconst Title = styled.h3`\n    padding: 6px;\n    margin: 3px;\n    display: flex;\n    width: 200px;\n`;\n\ninterface IYearViewProps {\n  id: string,\n  title: string,\n  year: number,\n  courseGroups: ICourseGroup[],\n  currentDraggableProps: ICurrentDraggableProps,\n\n  registerDraggableRef: (courseModel: CourseModel, ref: React.MutableRefObject<any>) => void\n  deregisterDraggableRef: (courseModel: CourseModel) => void\n\n  selectedCourses: CourseModel[];\n  draggingCourseId?: string;\n  onCourseClick: (course: CourseModel, event: MouseEvent) => void;\n\n  onCourseContextMenu: (course: CourseModel, event: MouseEvent) => void;\n\n  isRegionSelecting: boolean;\n}\n\nconst YearView = (props: IYearViewProps) => {\n  return (\n    <Container>\n      <Title>{props.year}</Title>\n      {\n        props.courseGroups.map(courseGroup => {\n          // console.log(`Rendering term ${courseGroup.title} with courses ${courseGroup.courses}`)\n          return (\n            <CourseGroupView\n              key={courseGroup.id}\n              id={courseGroup.id}\n              title={courseGroup.title}\n              courses={courseGroup.courses}\n              term={courseGroup.term}\n              currentDraggableProps={props.currentDraggableProps}\n              registerDraggableRef={props.registerDraggableRef}\n              deregisterDraggableRef={props.deregisterDraggableRef}\n              selectedCourses={props.selectedCourses}\n              draggingCourseId={props.draggingCourseId}\n              onCourseClick={props.onCourseClick}\n              onCourseContextMenu={props.onCourseContextMenu}\n              isRegionSelecting={props.isRegionSelecting}\n            />\n          )\n        })\n      }\n    </Container>\n  )\n};\nexport default YearView\n","import { observer, Observer } from \"mobx-react\";\nimport { Popup, Menu } from \"semantic-ui-react\";\nimport { ContextMenuViewModel } from \"./ContextMenuViewModel\";\n\nconst ContextMenu = observer(({ contextMenuViewModel }: { [key: string]: ContextMenuViewModel }) => {\n  return <Observer>\n    {() => {\n      return (\n        <Popup\n          basic\n          context={contextMenuViewModel.contextElement}\n          onClose={() => contextMenuViewModel.isContextOpen = false}\n          open={contextMenuViewModel.isContextOpen}\n        >\n          <Menu\n            items={contextMenuViewModel.contextMenuItems}\n            onItemClick={(e) => {\n              e.preventDefault();\n              contextMenuViewModel.isContextOpen = false;\n            }}\n            secondary\n            vertical\n          />\n        </Popup>\n      )\n    }}\n  </Observer>\n})\n\nexport default ContextMenu;","import { makeAutoObservable } from \"mobx\";\nimport { SerializedTerm, ISerializableEntity } from \"../interfaces/SerializableInterfaces\"\n\nexport class TermModel implements ISerializableEntity {\n    year: number;\n    name: string;\n\n    constructor(\n        year: number,\n        name: string,\n    ) {\n        makeAutoObservable(this);\n        this.checkTermConstraints(year, name);\n        \n        this.year = year;\n        this.name = name;\n    }\n\n    static termFromSerializedData(serializedTerm: SerializedTerm) {\n        return new TermModel(serializedTerm.year, serializedTerm.name);\n    }\n\n    private checkTermConstraints(year?: number, name?: string) {\n        if (!year) throw Error(`ERROR: ${year} is not a valid term year.`);\n        if (!name) throw Error(`ERROR: ${name} is not a valid term name.`);\n\n        // Do other term checks here\n    }\n\n    // getShortName() {\n    //     if (this.tryGetTermNumber()) {\n    //         return `${this.year % 100}T${this.tryGetTermNumber()}`\n    //     }\n    //     return `${this.year % 100} ${this.name}`\n    // }\n\n    get getMappingName() {\n        return `${this.year}_${this.name}`\n    }\n\n    update(year: number, name: string) {\n        this.year = year\n        this.name = name\n    }\n\n    updateFromMappingName(mappingName: string) {\n        let year = parseInt(mappingName.split('_')[0])\n        let name = mappingName.split('_')[1]\n        this.update(year, name)\n    }\n\n    get getFullName() {\n        return `${this.year} ${this.name}`\n    }\n\n    get getTermName() {\n        return `${this.name}`\n    }\n\n    static fromMappingName(mappingName: string) {\n        let year = parseInt(mappingName.split('_')[0])\n        let term_name = mappingName.split('_')[1]\n\n        return new TermModel(year, term_name)\n    }\n\n    private tryGetTermNumber(): number | undefined {\n        switch (this.name) {\n            case \"Summer Term\":\n                return 0\n            case \"Term 1\":\n                return 1\n            case \"Term 2\":\n                return 2\n            case \"Term 3\":\n                return 3\n            default:\n                return undefined\n        }\n    }\n\n    public equals(obj: TermModel | null): boolean {\n        if (!obj) {\n            return false\n        }\n        return this.year === obj.year && this.name === obj.name\n    }\n\n    public isBefore(term: TermModel) {\n        return this.year < term.year\n            || (term.year === this.year && ( (this.tryGetTermNumber() ?? 99) < (term.tryGetTermNumber() ?? 99)) );\n    }\n\n    serialize(): SerializedTerm {\n        return {\n            year: this.year,\n            name: this.name,\n        };\n    }\n\n    deserialize(serializedTerm: SerializedTerm): Promise<void> {\n        throw Error(`ERROR: use static method termFromSerializedData to construct the term from serialized data ${serializedTerm}.`);\n    }\n}\n","import { autorun, makeAutoObservable, reaction, runInAction } from \"mobx\";\nimport { CourseModel } from \"../../models/CourseModel\";\nimport { FilterModel } from \"../../models/Filters/FilterModel\";\nimport { getCourseFilters, getProgramFilters, getSpecialisationFilters } from \"../../models/Filters/Filters\";\nimport { ProgramModel } from \"../../models/ProgramModel\";\nimport { SpecialisationModel } from \"../../models/SpecialisationModel\";\nimport { SearchDataState } from \"../../states/SearchDataState\";\n\nexport interface ISearchQuery<T> {\n  queryText: string,\n  filters: FilterModel<T>[],\n}\n\nexport interface ISearchResults {\n  courseSearchResults: CourseModel[],\n  programSearchResults: ProgramModel[],\n  specialisationSearchResults: SpecialisationModel[],\n}\n\nexport interface ISearchFilters {\n  courseFilters: FilterModel<CourseModel>[],\n  programFilters: FilterModel<ProgramModel>[],\n  specialisationFilters: FilterModel<SpecialisationModel>[],\n}\n\nexport enum SearchPanelItem {\n  COURSES,\n  PROGRAMS,\n  SPECIALISATIONS,\n}\n\nexport class SearchPanelViewModel {\n  constructor(\n    public readonly searchDataState: SearchDataState,\n  ) {\n    makeAutoObservable<SearchPanelViewModel>(this)\n\n    reaction(() => searchDataState.courseSearchData, () => {\n      this.setIsLoading(false)\n      this.searchFilters.courseFilters = getCourseFilters(searchDataState.courseSearchData)\n    }, {fireImmediately: true})\n\n    reaction(() => searchDataState.programSearchData, () => {\n      this.setIsLoading(false)\n      this.searchFilters.programFilters = getProgramFilters(searchDataState.programSearchData)\n    }, {fireImmediately: true})\n\n    reaction(() => searchDataState.specialisationSearchData, () => {\n      this.setIsLoading(false)\n      this.searchFilters.specialisationFilters = getSpecialisationFilters(searchDataState.specialisationSearchData)\n    }, {fireImmediately: true})\n\n    autorun(() => {\n      this.searchCourses()\n    });\n\n    autorun(() => {\n      this.searchPrograms()\n    });\n\n    autorun(() => {\n      this.searchSpecialisations()\n    });\n  }\n\n  public queryText: string = \"\"\n  public isLoading: boolean = true\n  public resultsPerPage: number = 10\n  public isInputActive: boolean = false\n  public searchFilters: ISearchFilters = {\n    courseFilters: [],\n    programFilters: [],\n    specialisationFilters: [],\n  }\n  public searchResults: ISearchResults = {\n    courseSearchResults: [],\n    programSearchResults: [],\n    specialisationSearchResults: [],\n  }\n  public activeItem: SearchPanelItem = SearchPanelItem.COURSES\n\n  public setActiveItem = (item: SearchPanelItem) => {\n    this.activeItem = item\n  }\n\n  get shouldShowPanel() {\n    return this.isInputActive || this.queryText.length > 0\n  }\n\n  setInputActive(isInputActive: boolean) {\n    this.isInputActive = isInputActive;\n  }\n\n  setQueryText(queryText: string) {\n    this.queryText = queryText\n  }\n\n  setIsLoading(isLoading: boolean) {\n    this.isLoading = isLoading\n  }\n\n  setResultsPerPage(resultsPerPage: number) {\n    this.resultsPerPage = resultsPerPage\n  }\n\n  searchCourses() {\n    let results = this.searchDataState.courseSearchData\n    if (this.queryText !== \"\") {\n      results = this.searchDataState.courseSearchData\n        .filter(course => {\n          return course.code.toLowerCase().includes(this.queryText.toLowerCase())\n            || course.title.toLowerCase().includes(this.queryText.toLowerCase())\n        })\n    }\n    this.searchFilters.courseFilters.forEach((filter) => {\n      results = filter.applyFilter(results)\n    })\n    runInAction(() => this.searchResults.courseSearchResults = results)\n  }\n  \n\n  searchPrograms() {\n    let results = this.searchDataState.programSearchData\n    if (this.queryText !== \"\") {\n      results = this.searchDataState.programSearchData\n        .filter(program => {\n          return program.code.toLowerCase().includes(this.queryText.toLowerCase())\n            || program.title.toLowerCase().includes(this.queryText.toLowerCase())\n        })\n    }\n    this.searchFilters.programFilters.forEach((filter) => {\n      results = filter.applyFilter(results)\n    })\n    runInAction(() => this.searchResults.programSearchResults = results)\n  }\n\n  searchSpecialisations() {\n    let results = this.searchDataState.specialisationSearchData\n    if (this.queryText !== \"\") {\n      results = this.searchDataState.specialisationSearchData\n        .filter(specialisation => {\n          return specialisation.code.toLowerCase().includes(this.queryText.toLowerCase())\n            || specialisation.title.toLowerCase().includes(this.queryText.toLowerCase())\n        })\n    }\n    this.searchFilters.specialisationFilters.forEach((filter) => {\n      results = filter.applyFilter(results)\n    })\n    runInAction(() => this.searchResults.specialisationSearchResults = results)\n  }\n\n\n}\n","import { computed, makeObservable, observable } from \"mobx\";\nimport { MenuItemProps } from \"semantic-ui-react\";\nimport { CourseModel, CourseStatus } from \"../../../../models/CourseModel\";\nimport { PlannerViewModel } from \"../../PlannerViewModel\";\n\nexport class ContextMenuViewModel {\n  constructor(plannerViewModel: PlannerViewModel) {\n\n    makeObservable<ContextMenuViewModel, \"_isContextOpen\">(this, {\n      _isContextOpen: observable,\n      isContextOpen: computed,\n    })\n\n    this._plannerViewModel = plannerViewModel;\n    this._contextMenuItems = this.getContextMenuItems();\n  }\n\n  private _plannerViewModel: PlannerViewModel;\n\n  private _isContextOpen = false;\n  get isContextOpen() {\n    return this._isContextOpen;\n  }\n  set isContextOpen(state: boolean) {\n    this._isContextOpen = state;\n  }\n\n  private _contextElement: any;\n  get contextElement(): any {\n    return this._contextElement;\n  }\n  set contextElement(element: any) {\n    this._contextElement = element;\n  }\n\n  getContextMenuItems(course?: CourseModel): MenuItemProps[] {\n    const areMultipleItems = this._plannerViewModel.selectedCourses.length > 1;\n    const menuItems: { [key: string]: MenuItemProps } = {\n      remove: {\n        key: 'remove',\n        content: `Remove ${areMultipleItems ? \"all courses\" : \"course\"}`,\n        icon: 'delete calendar',\n        onClick: this._plannerViewModel.transaction(() => {\n          const moveSelectedToRemoved = () => {\n            this._plannerViewModel.selectedCourses.forEach((courseModel) => courseModel.setUnplanned());\n            this._plannerViewModel.unselectAllCourses();\n          }\n          if (!course) {\n            moveSelectedToRemoved();\n          } else {\n            if (this._plannerViewModel.selectedCourses.includes(course)) moveSelectedToRemoved();\n            course.setUnplanned();\n          }\n          this._plannerViewModel.synchronizePlannerState();\n        })\n      },\n      plan: {\n        key: 'plan',\n        content: `Move ${areMultipleItems ? \"all courses\" : \"course\"} to planned`,\n        icon: 'bookmark',\n        onClick: this._plannerViewModel.transaction(() => {\n          const moveSelectedToPlanned = () => {\n            this._plannerViewModel.selectedCourses.forEach((courseModel) => courseModel.setPlanned());\n          }\n          if (!course) {\n            moveSelectedToPlanned();\n          } else {\n            if (this._plannerViewModel.selectedCourses.includes(course)) moveSelectedToPlanned();\n            course.setPlanned();\n          }\n          this._plannerViewModel.synchronizePlannerState();\n        })\n      },\n      complete: {\n        key: 'complete',\n        content: `Move ${areMultipleItems ? \"all courses\" : \"course\"} to completed`,\n        icon: 'checked calendar',\n        onClick: this._plannerViewModel.transaction(() => {\n          const moveSelectedToCompleted = () => {\n            this._plannerViewModel.selectedCourses.forEach((courseModel) => courseModel.setCompleted());\n          }\n          if (!course) {\n            moveSelectedToCompleted();\n          } else {\n            if (this._plannerViewModel.selectedCourses.includes(course)) moveSelectedToCompleted();\n            course.setCompleted();\n          }\n          this._plannerViewModel.synchronizePlannerState();\n        })\n      },\n    };\n    if (course) {\n      if (course.courseStatus === CourseStatus.UNPLANNED) {\n        const { remove, ...items } = menuItems;\n        return Object.values(items);\n      } else if (course.courseStatus === CourseStatus.PLANNED) {\n        const { plan, ...items } = menuItems;\n        return Object.values(items);\n      } else if (course.courseStatus === CourseStatus.COMPLETED) {\n        const { complete, ...items } = menuItems;\n        return Object.values(items);\n      }\n    }\n    return Object.values(menuItems);\n  }\n\n  private _contextMenuItems: MenuItemProps[] = [];\n  get contextMenuItems(): MenuItemProps[] {\n    return this._contextMenuItems;\n  }\n  set contextMenuItems(items: MenuItemProps[]) {\n    this._contextMenuItems = items;\n  }\n\n  openContext = (event: MouseEvent) => {\n    this._contextElement = {\n      getBoundingClientRect: () => ({\n        left: event.clientX,\n        top: event.clientY,\n        right: event.clientX + 1,\n        bottom: event.clientY + 1,\n        height: 0,\n        width: 0,\n      }),\n    }\n    this.isContextOpen = true;\n  }\n\n  onWindowContextMenu = (event: MouseEvent) => {\n    if (event.defaultPrevented) return;\n\n    // Don't use context when no items selected. Possibly change this.\n    if (this._plannerViewModel.selectedCourses.length === 0) return;\n\n    event.preventDefault();\n    this.contextMenuItems = this.getContextMenuItems();\n\n    this.openContext(event);\n  }\n\n  onCourseContextMenu = (course: CourseModel, event: MouseEvent) => {\n    // If course not in selectedCourses, toggle selection\n    if (!this._plannerViewModel.selectedCourses.find((selectedCourse: CourseModel) => selectedCourse.id === course.id)) {\n      this._plannerViewModel.toggleSelection(course);\n    }\n\n    event.preventDefault()\n    this.contextMenuItems = this.getContextMenuItems(course);\n\n    this.openContext(event);\n  }\n}","import React from \"react\";\nimport { Box, boxesIntersect, useSelectionContainer } from \"react-drag-to-select\";\nimport { CourseModel } from \"../../../../models/CourseModel\";\nimport { PlannerViewModel } from \"../../PlannerViewModel\";\n\ninterface RegionSelectProps {\n  plannerViewModel: PlannerViewModel,\n  setIsRegionSelecting: (b: boolean) => void;\n  draggableItemsMap: Map<CourseModel, HTMLDivElement>,\n}\n\nconst RegionSelect = (props: RegionSelectProps) => {\n  const draggableBoxesRef = React.useRef<[CourseModel, Box][]>([]);\n\n  const { DragSelection } = useSelectionContainer({\n    onSelectionStart: () => {\n      props.setIsRegionSelecting(true);\n      draggableBoxesRef.current = [...props.draggableItemsMap.entries()].reduce((previous: [CourseModel, Box][], [courseModel, div]): [CourseModel, Box][] => {\n        const rect = div.getBoundingClientRect();\n        return [\n          ...previous,\n          [courseModel, rect]\n        ];\n      }, []);\n    },\n    onSelectionChange: (box: Box) => {\n      draggableBoxesRef.current\n        .filter(([courseModel, draggableBox]) => {\n          const isSelected: boolean = props.plannerViewModel.selectedCourses.includes(courseModel);\n          const isIntersecting: boolean = boxesIntersect(box, draggableBox);\n\n          return (isSelected !== isIntersecting);\n        }, [])\n        .forEach(([courseModel, _]) => props.plannerViewModel.toggleSelectionInGroup(courseModel));\n    },\n    onSelectionEnd: () => {\n      draggableBoxesRef.current = [];\n    }\n  });\n\n  return (<DragSelection />)\n}\n\nexport default RegionSelect;","import React from \"react\";\nimport { DragDropContext, DragStart, DropResult } from \"react-beautiful-dnd\";\nimport { CourseModel } from \"../../../../models/CourseModel\";\nimport { ICourseGroup, PlannerViewModel } from \"../../PlannerViewModel\";\n\ninterface DraggingProps extends React.PropsWithChildren<any> {\n  plannerViewModel: PlannerViewModel\n  setIsDragging: React.Dispatch<React.SetStateAction<boolean>>\n\n}\n\nconst Dragging = (props: DraggingProps) => {\n  const courseState = props.plannerViewModel.courseState;\n\n  const onDragStart = (initial: DragStart) => {\n    props.setIsDragging(true);\n\n    const selected: CourseModel | undefined = props.plannerViewModel.selectedCourses.find(\n      (course: CourseModel): boolean => course.id === initial.draggableId,\n    );\n\n    if (!selected) props.plannerViewModel.unselectAllCourses();\n\n    props.plannerViewModel.draggingCourseId = initial.draggableId;\n\n    const course = courseState.getCourseById(initial.draggableId);\n\n    if (!course) return;\n\n    // Don't calculate validations if we are multi selecting\n    if (props.plannerViewModel.selectedCourses.length > 1) return;\n\n    props.plannerViewModel.currentDraggableProps = {\n      ...props.plannerViewModel.currentDraggableProps,\n      possibleTerms: props.plannerViewModel.calculateDisplayableTerms().filter(term => {\n        return courseState.getMissingRequirementsWhenAssigningCourseToTerm(course, term).length === 0\n      }),\n      prerequisiteCourseIds: new Set<string>(courseState.getFlattenedPrerequisiteList(course.prerequisites))\n    }\n  }\n\n  const onDragEnd = props.plannerViewModel.transaction((result: DropResult) => {\n    const { destination, source } = result;\n    if (!destination || result.reason === \"CANCEL\") {\n      props.plannerViewModel.draggingCourseId = undefined;\n      return;\n    }\n    if (!props.plannerViewModel.draggingCourseId) return;\n\n    props.plannerViewModel.selectedCourses.forEach((course: CourseModel) =>\n      props.plannerViewModel.setCourseByDroppableId(course, source.droppableId, destination.droppableId)\n    );\n\n    const allGroups = props.plannerViewModel.getAllGroups();\n    allGroups.forEach((group: ICourseGroup) => {\n      group.courses = group.courses.filter((courseInGroup: CourseModel) =>\n        !props.plannerViewModel.selectedCourses.find((selectedCourse: CourseModel) =>\n          selectedCourse.id === courseInGroup.id\n        )\n      )\n    })\n    props.plannerViewModel.spliceByGroupId(destination.droppableId, destination.index, 0, ...props.plannerViewModel.selectedCourses)\n\n    const draggingCourseIsSelected: boolean = !!props.plannerViewModel.selectedCourses.find((courseModel) => {\n      return courseModel.id === props.plannerViewModel.draggingCourseId;\n    });\n    if (!draggingCourseIsSelected) {\n      const courseModel = courseState.getCourseById(props.plannerViewModel.draggingCourseId);\n      if (courseModel) {\n        props.plannerViewModel.setCourseByDroppableId(courseModel, source.droppableId, destination.droppableId);\n        props.plannerViewModel.spliceByGroupId(source.droppableId, source.index, 1);\n        props.plannerViewModel.spliceByGroupId(destination.droppableId, destination.index + props.plannerViewModel.selectedCourses.length, 0, courseModel);\n      }\n    }\n\n    props.setIsDragging(false);\n\n    props.plannerViewModel.draggingCourseId = undefined;\n\n    props.plannerViewModel.clearCurrentDraggableProps()\n  });\n\n  const onBeforeCapture = () => {\n    props.plannerViewModel.currentDraggableProps = {\n      ...props.plannerViewModel.currentDraggableProps,\n      isDragging: true,\n    }\n  }\n\n  return (\n    <DragDropContext\n      onBeforeCapture={onBeforeCapture}\n      onDragStart={onDragStart}\n      onDragEnd={onDragEnd}\n    >\n      {props.children}\n    </DragDropContext>\n  )\n}\nexport default Dragging;","import { Observer, observer } from 'mobx-react';\nimport React, { useEffect } from 'react';\nimport styled from 'styled-components'\nimport { PlannerViewModel } from './PlannerViewModel';\nimport CourseGroupView from './CourseGroupView/CourseGroupView';\nimport YearView from './YearView/YearView';\nimport { CourseModel } from '../../models/CourseModel';\nimport ContextMenu from \"./components/ContextMenu/ContextMenuView\"\nimport { ContextMenuViewModel } from './components/ContextMenu/ContextMenuViewModel';\nimport RegionSelect from './components/RegionSelect/RegionSelectView';\nimport Dragging from './components/Dragging/DraggingView';\nimport { Icon } from 'semantic-ui-react';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: row;\n`\n\nconst YearPlanner = styled.div`\n  display: inherit;\n  overflow: auto;\n`\n\nconst Planner = observer(({ plannerViewModel }: { [key: string]: PlannerViewModel }) => {\n  return <Observer>\n    {() => {\n      const plannerState = plannerViewModel.plannerState;\n\n      const contextMenuViewModel = new ContextMenuViewModel(plannerViewModel);\n\n      useEffect(() => {\n        window.addEventListener(\"keydown\", onWindowKeyDown);\n        window.addEventListener(\"contextmenu\", contextMenuViewModel.onWindowContextMenu);\n        window.addEventListener(\"dragenter\", onDragEnter);\n        window.addEventListener(\"dragexit\", onDragExit);\n        window.addEventListener(\"mouseup\", onMouseUp);\n\n        return () => {\n          window.removeEventListener(\"keydown\", onWindowKeyDown);\n          window.removeEventListener(\"contextmenu\", contextMenuViewModel.onWindowContextMenu);\n          window.removeEventListener(\"dragenter\", onDragEnter);\n          window.removeEventListener(\"dragexit\", onDragExit);\n          window.removeEventListener(\"mouseup\", onMouseUp);\n        }\n      });\n\n      // Drag region selection\n      const draggableItemsRef = React.useRef(new Map<CourseModel, HTMLDivElement>());\n      const [isRegionSelecting, setIsRegionSelecting] = React.useState(false);\n\n      const registerDraggable = (courseModel: CourseModel, ref: React.MutableRefObject<HTMLDivElement | null | undefined>) => {\n        if (!ref.current) return;\n        draggableItemsRef.current.set(courseModel, ref.current);\n      }\n      const deregisterDraggable = (courseModel: CourseModel) => {\n        draggableItemsRef.current.delete(courseModel);\n      }\n\n      // Dragging\n      const [isDragging, setIsDragging] = React.useState(false);\n\n      // Multi select\n      const onWindowKeyDown = (event: KeyboardEvent) => {\n        if (event.defaultPrevented) return;\n\n        if (event.key === \"Escape\") plannerViewModel.unselectAllCourses();\n      }\n\n      const onMouseUp = (event: MouseEvent) => {\n        if (contextMenuViewModel.isContextOpen) return;\n\n        if (isDragging) return;\n\n        event.preventDefault();\n\n        if (isRegionSelecting) {\n          setIsRegionSelecting(false);\n          return;\n        }\n\n        if (event.button !== 0) return;\n        if (event.ctrlKey) return;\n\n        plannerViewModel.unselectAllCourses();\n      }\n\n      const onDragEnter = (event) => {\n        event.preventDefault();\n      }\n\n      const onDragExit = (event) => {\n        event.preventDefault();\n      }\n\n      const onCourseClick = (course: CourseModel, event: MouseEvent) => {\n        const wasToggleInSelectionGroupKeyUsed = (event: MouseEvent | KeyboardEvent) => {\n          return navigator.platform.includes('Mac')\n            ? event.metaKey\n            : event.ctrlKey;\n        };\n\n        if (event.defaultPrevented) return;\n\n        if (event.button !== 0) return;\n\n        if (isRegionSelecting) return;\n\n        event.preventDefault();\n        if (contextMenuViewModel.isContextOpen) return;\n\n        if (wasToggleInSelectionGroupKeyUsed(event)) {\n          plannerViewModel.toggleSelectionInGroup(course);\n          return;\n        }\n\n        plannerViewModel.toggleSelection(course);\n      }\n\n      return (\n        <React.Fragment>\n          <RegionSelect\n            plannerViewModel={plannerViewModel}\n            draggableItemsMap={draggableItemsRef.current}\n            setIsRegionSelecting={setIsRegionSelecting}\n          />\n          <ContextMenu\n            contextMenuViewModel={contextMenuViewModel}\n          />\n          <Dragging\n            plannerViewModel={plannerViewModel}\n            setIsDragging={setIsDragging}\n          >\n            {\n              <CourseGroupView\n                horizontal={true}\n                key={plannerState.completedGroup.id}\n                id={plannerState.completedGroup.id}\n                title={plannerState.completedGroup.title}\n                term={null}\n                courses={plannerState.completedGroup.courses}\n                currentDraggableProps={plannerViewModel.currentDraggableProps}\n                selectedCourses={plannerViewModel.selectedCourses}\n                draggingCourseId={plannerViewModel.draggingCourseId}\n                onCourseClick={onCourseClick}\n                onCourseContextMenu={contextMenuViewModel.onCourseContextMenu}\n                isRegionSelecting={isRegionSelecting}\n                registerDraggableRef={registerDraggable}\n                deregisterDraggableRef={deregisterDraggable}\n              />\n            }\n            <Container>\n              {\n                <CourseGroupView\n                  horizontal={false}\n                  key={plannerState.plannedGroup.id}\n                  id={plannerState.plannedGroup.id}\n                  title={plannerState.plannedGroup.title}\n                  term={null}\n                  courses={plannerState.plannedGroup.courses}\n                  currentDraggableProps={plannerViewModel.currentDraggableProps}\n                  selectedCourses={plannerViewModel.selectedCourses}\n                  draggingCourseId={plannerViewModel.draggingCourseId}\n                  onCourseClick={onCourseClick}\n                  onCourseContextMenu={contextMenuViewModel.onCourseContextMenu}\n                  isRegionSelecting={isRegionSelecting}\n                  registerDraggableRef={registerDraggable}\n                  deregisterDraggableRef={deregisterDraggable}\n                />\n              }\n              <YearPlanner>\n                {\n                  plannerState.yearGroups.map(yearGroup => {\n                    return <YearView\n                      id={yearGroup.id}\n                      title={yearGroup.title}\n                      year={yearGroup.year}\n                      courseGroups={yearGroup.courseGroups}\n                      currentDraggableProps={plannerViewModel.currentDraggableProps}\n                      selectedCourses={plannerViewModel.selectedCourses}\n                      draggingCourseId={plannerViewModel.draggingCourseId}\n                      onCourseClick={onCourseClick}\n                      onCourseContextMenu={contextMenuViewModel.onCourseContextMenu}\n                      isRegionSelecting={isRegionSelecting}\n                      registerDraggableRef={registerDraggable}\n                      deregisterDraggableRef={deregisterDraggable}\n                    />\n                  })\n                }\n              </YearPlanner>\n            </Container>\n            {\n              plannerViewModel.currentDraggableProps.isDragging\n                ?\n                <CourseGroupView\n                  horizontal={true}\n                  key={\"trash\"}\n                  id={\"trash\"}\n                  title={\"Remove\"}\n                  term={null}\n                  courses={[]}\n                  currentDraggableProps={plannerViewModel.currentDraggableProps}\n                  selectedCourses={plannerViewModel.selectedCourses}\n                  draggingCourseId={plannerViewModel.draggingCourseId}\n                  onCourseClick={onCourseClick}\n                  onCourseContextMenu={contextMenuViewModel.onCourseContextMenu}\n                  isRegionSelecting={isRegionSelecting}\n                  registerDraggableRef={registerDraggable}\n                  deregisterDraggableRef={deregisterDraggable}\n                />\n                : <></>\n            }\n          </Dragging>\n          <Icon link name=\"redo\" size=\"large\" onClick={() => plannerViewModel.undoTransaction()} />\n        </React.Fragment>\n      )\n    }}\n  </Observer >\n})\n\nexport default Planner;\n","import { action, computed, makeObservable, observable } from \"mobx\";\nimport { CourseModel } from \"../../models/CourseModel\";\nimport { TermModel } from \"../../models/TermModel\";\nimport { CourseState } from \"../../states/CourseState\";\n\nexport interface ICourseGroup {\n  id: string,\n  title: string,\n  term: TermModel | null,\n  courses: CourseModel[],\n}\n\nexport interface IYearGroup {\n  id: string,\n  year: number\n  title: string,\n  courseGroups: ICourseGroup[],\n}\n\nexport interface IPlannerState {\n  id: string,\n  title: string,\n  allocatedGroups: ICourseGroup[],\n  yearGroups: IYearGroup[],\n  completedGroup: ICourseGroup,\n  plannedGroup: ICourseGroup,\n}\n\nexport interface ICurrentDraggableProps {\n  isDragging: boolean,\n  possibleTerms: TermModel[]\n  prerequisiteCourseIds: Set<string>\n}\n\ninterface ITransaction {\n  type: \"+\" | \"-\",\n  index: number,\n  courses: CourseModel[],\n  groupId: string,\n}\n\ntype PreviousTransaction = {\n  selectedCourses: CourseModel[],\n  deltas: ITransaction[],\n}\n\nexport class PlannerViewModel {\n  constructor(courseState: CourseState) {\n    makeObservable<PlannerViewModel,\n      \"_currentDraggableProps\" | \"_selectedCourses\" | \"_draggingCourseId\"\n    >(this, {\n      _currentDraggableProps: observable,\n      currentDraggableProps: computed,\n      clearCurrentDraggableProps: action,\n\n      _selectedCourses: observable,\n      selectedCourses: computed,\n\n      _draggingCourseId: observable,\n      draggingCourseId: computed,\n    })\n\n    this._courseState = courseState\n    this._plannerState = {\n      id: \"plannerState\",\n      title: \"Visualizer\",\n      allocatedGroups: [],\n      yearGroups: [],\n      completedGroup: {\n        id: \"completed\",\n        title: \"Completed\",\n        term: null,\n        courses: [],\n      },\n      plannedGroup: {\n        id: \"planned\",\n        title: \"Planned\",\n        term: null,\n        courses: [],\n      },\n    }\n  }\n\n  private _courseState: CourseState\n  get courseState(): CourseState {\n    return this._courseState\n  }\n\n  private _plannerState: IPlannerState\n  get plannerState(): IPlannerState {\n    this.synchronizePlannerState()\n    return this._plannerState\n  }\n\n  //#region selectedCourses\n\n  private _selectedCourses: CourseModel[] = [];\n\n  get selectedCourses(): CourseModel[] {\n    return this._selectedCourses;\n  }\n\n  set selectedCourses(state: CourseModel[]) {\n    this._selectedCourses = state;\n  }\n\n  unselectAllCourses() {\n    this.selectedCourses = [];\n  }\n\n  toggleSelection(course: CourseModel) {\n    const selectedCourses = this.selectedCourses;\n    const wasSelected: boolean = selectedCourses.includes(course);\n\n    const newCourses = (() => {\n      // Task not previously selected or part of the selected group, now the only selected item\n      if (!wasSelected || selectedCourses.length > 1) {\n        return [course];\n      }\n\n      // Task previously selected but not in a group, clear the selection\n      return [];\n    })();\n\n    this.selectedCourses = newCourses;\n  }\n\n  toggleSelectionInGroup(course: CourseModel) {\n    const selectedCourses = this.selectedCourses;\n    const index: number = selectedCourses.indexOf(course);\n\n    // if not selected - add it to the selected items\n    if (index === -1) {\n      this.selectedCourses = [...selectedCourses, course];\n      return;\n    }\n\n    // it was previously selected and now needs to be removed from the group\n    const newCourses: CourseModel[] = [...selectedCourses];\n    newCourses.splice(index, 1);\n    this.selectedCourses = newCourses;\n  };\n\n  //#endregion\n\n  private _MAX_BUFFER = 5;\n  private _transactionBuffer: PreviousTransaction[] = [];\n  private _previousState: undefined | IPlannerState;\n\n  private getDifferences(A: CourseModel[], B: CourseModel[], groupId: string): ITransaction[] {\n    const isEqual = (c1: CourseModel, c2: CourseModel) => c1.id === c2.id;\n\n    let differences: ITransaction[] = [];\n    let iA = 0; let iB = 0;\n    while (iA < A.length && iB < B.length) {\n      if (isEqual(A[iA], B[iB])) {\n        // no change\n        iA++;\n        iB++;\n      } else {\n        // a change\n        const indexOfAElemInB = B.findIndex((bCourse) => isEqual(bCourse, A[iA]));\n        if (indexOfAElemInB === -1) {\n          // iA was removed from A\n          differences.push({\n            type: \"-\",\n            index: iA,\n            courses: [A[iA]],\n            groupId,\n          });\n          iA++;\n        } else {\n          // the elements from iB to indexOfAElemInB were inserted at iA\n          differences.push({\n            type: \"+\",\n            index: iA,\n            courses: [...B.slice(iB, indexOfAElemInB)],\n            groupId,\n          });\n          iB = indexOfAElemInB;\n        }\n      }\n    }\n    if (iA < A.length) {\n      // the rest of A from iA was removed\n      differences.push({\n        type: \"-\",\n        index: iA,\n        courses: [...A.slice(iA)],\n        groupId,\n      });\n    }\n    if (iB < B.length) {\n      // the rest of B from iB was added in\n      differences.push({\n        type: \"+\",\n        index: iA,\n        courses: [...B.slice(iB)],\n        groupId,\n      });\n    }\n    return differences;\n  }\n\n  private startTransaction() {\n    this._previousState = {\n      ...this._plannerState,\n      plannedGroup: {\n        ...this._plannerState.plannedGroup,\n        courses: this._plannerState.plannedGroup.courses.slice(),\n      },\n      completedGroup: {\n        ...this._plannerState.completedGroup,\n        courses: this._plannerState.completedGroup.courses.slice(),\n      },\n      allocatedGroups: this._plannerState.allocatedGroups.map((group) => ({\n        ...group,\n        courses: group.courses.slice(),\n      })),\n      yearGroups: this._plannerState.yearGroups.map((yearGroup) => ({\n        ...yearGroup,\n        courseGroups: yearGroup.courseGroups.map((courseGroup) => ({\n          ...courseGroup,\n          courses: courseGroup.courses.slice(),\n        }))\n      }))\n    };\n  }\n\n  private endTransaction() {\n    if (!this._previousState) return;\n    console.log(\"end\")\n    let transaction: PreviousTransaction = {\n      selectedCourses: this.selectedCourses.slice(),\n      deltas: [],\n    }\n\n    transaction.deltas.push(...this.getDifferences(this._previousState.plannedGroup.courses, this._plannerState.plannedGroup.courses, this._previousState.plannedGroup.id));\n    transaction.deltas.push(...this.getDifferences(this._previousState.completedGroup.courses, this._plannerState.completedGroup.courses, this._previousState.completedGroup.id));\n    transaction.deltas.push(...this._previousState.allocatedGroups.reduce((previous: ITransaction[], previousGroup, i): ITransaction[] => {\n      return [...previous, ...this.getDifferences(previousGroup.courses, this._plannerState.allocatedGroups[i].courses, previousGroup.id)]\n    }, []))\n\n    if (this._transactionBuffer.length >= this._MAX_BUFFER) {\n      this._transactionBuffer.pop();\n    }\n    this._transactionBuffer.unshift(transaction);\n    this._previousState = undefined;\n  }\n\n  transaction<\n    Fn extends (this: any, ...args: any[]) => ReturnType<Fn>\n  >(callback: Fn): Fn {\n    const plannerViewModel = this;\n\n    function wrappedCallback(this: unknown, ...args: unknown[]): void {\n      plannerViewModel.startTransaction();\n      callback.apply(this, args)\n      plannerViewModel.endTransaction();\n    }\n\n    return wrappedCallback as Fn;\n  }\n\n  undoTransaction() {\n    const lastTransaction = this._transactionBuffer.shift();\n    if (!lastTransaction) return;\n\n    console.log(lastTransaction)\n\n    this.selectedCourses = lastTransaction.selectedCourses;\n\n    lastTransaction.deltas.forEach((transaction: ITransaction) => {\n      if (transaction.type === \"+\") {\n        this.getCourseGroupById(transaction.groupId)?.courses.splice(transaction.index, transaction.courses.length);\n      } else if (transaction.type === \"-\") {\n        transaction.courses.forEach((courseModel) => {\n          if (transaction.groupId === \"trash\") courseModel.setUnplanned();\n          else if (transaction.groupId === \"planned\") courseModel.setPlanned();\n          else if (transaction.groupId === \"completed\") courseModel.setCompleted();\n          else courseModel.setAllocated(TermModel.fromMappingName(transaction.groupId));\n        });\n        this.getCourseGroupById(transaction.groupId)?.courses.splice(transaction.index, 0, ...transaction.courses);\n      }\n    })\n\n    this.synchronizePlannerState();\n  }\n\n  setCourseByDroppableId(course: CourseModel, sourceDroppableId: string, destDroppableId: string) {\n    if (sourceDroppableId === destDroppableId) return;\n\n    if (destDroppableId === \"trash\") {\n      course.setUnplanned()\n    } else if (destDroppableId === \"completed\") {\n      course.setCompleted()\n    } else if (destDroppableId === \"planned\") {\n      course.setPlanned()\n    } else {\n      course.setAllocated(TermModel.fromMappingName(destDroppableId))\n    }\n  }\n\n  //#region draggingCourseId\n\n  private _draggingCourseId: undefined | string = undefined;\n  get draggingCourseId(): undefined | string {\n    return this._draggingCourseId;\n  }\n  set draggingCourseId(id: undefined | string) {\n    this._draggingCourseId = id;\n  }\n\n  //#endregion\n\n  private synchronizeCourseList(referenceCourses: CourseModel[], targetCourses: CourseModel[]): void {\n    let expectedCourses = new Set(referenceCourses)\n    let actualCourses = new Set(targetCourses)\n\n    let coursesToRemove = new Set([...actualCourses].filter(course => !expectedCourses.has(course)))\n    let coursesToAdd = new Set([...expectedCourses].filter(course => !actualCourses.has(course)))\n\n    coursesToRemove.forEach(course => {\n      let index = targetCourses.indexOf(course)\n      targetCourses.splice(index, 1)\n    })\n\n    coursesToAdd.forEach(course => {\n      targetCourses.push(course)\n    })\n  }\n\n  calculateDisplayableTerms(): TermModel[] {\n    let maxAllocatedYear = this._courseState.getMaxAllocatedYear\n    const currentYear = new Date().getFullYear()\n    let displayableTerms: TermModel[] = []\n    for (let year: number = currentYear; year <= maxAllocatedYear + 1; ++year) {\n      displayableTerms.push(new TermModel(year, \"Summer Term\"))\n      displayableTerms.push(new TermModel(year, \"Term 1\"))\n      displayableTerms.push(new TermModel(year, \"Term 2\"))\n      displayableTerms.push(new TermModel(year, \"Term 3\"))\n    }\n    return displayableTerms\n  }\n\n  synchronizePlannerState(): void {\n    const displayableTerms = this.calculateDisplayableTerms()\n    const uniqueYears = [...new Set(displayableTerms.map(term => term.year))].sort()\n    const allocatedGroups: ICourseGroup[] = displayableTerms.map((term: TermModel) => {\n      return {\n        id: term.getMappingName,\n        title: term.getFullName,\n        term: term,\n        courses: this._plannerState.allocatedGroups.find(group => group.id === term.getMappingName)?.courses ?? [],\n      }\n    })\n    let newPlannerState: IPlannerState = {\n      ...this._plannerState,\n      allocatedGroups: allocatedGroups,\n      yearGroups: uniqueYears.map((year: number) => {\n        return {\n          id: `yearGroup_${year.toString()}`,\n          title: year.toString(),\n          year: year,\n          courseGroups: allocatedGroups.filter(group => group.term?.year === year) ?? [],\n        }\n      }),\n    }\n\n    newPlannerState.allocatedGroups.forEach((courseGroup: ICourseGroup) => {\n      this.synchronizeCourseList(this._courseState.termCourseMap.get(courseGroup.id) ?? [], courseGroup.courses)\n    })\n\n    newPlannerState.yearGroups.forEach(yearGroup => {\n      yearGroup.courseGroups.forEach((courseGroup: ICourseGroup) => {\n        this.synchronizeCourseList(this._courseState.termCourseMap.get(courseGroup.id) ?? [], courseGroup.courses)\n      })\n    })\n\n    this.synchronizeCourseList(this._courseState.plannedCourses, newPlannerState.plannedGroup.courses)\n    this.synchronizeCourseList(this._courseState.completedCourses, newPlannerState.completedGroup.courses)\n    this._plannerState = newPlannerState\n  }\n\n  private getCourseGroupById(groupId: string): ICourseGroup | undefined {\n    if (this._plannerState.completedGroup.id === groupId) {\n      return this._plannerState.completedGroup\n    } else if (this._plannerState.plannedGroup.id === groupId) {\n      return this._plannerState.plannedGroup\n    } else {\n      return this._plannerState.allocatedGroups.find(group => group.id === groupId)\n    }\n  }\n\n  getAllGroups(): ICourseGroup[] {\n    return [this._plannerState.completedGroup, this._plannerState.plannedGroup, ...this._plannerState.allocatedGroups];\n  }\n\n  spliceByGroupId(droppableId: string, start: number, deleteCount?: number): CourseModel[];\n\n  spliceByGroupId(droppableId: string, start: number, deleteCount: number, ...items: CourseModel[]): CourseModel[];\n\n  spliceByGroupId(droppableId: string, start: number, deleteCount?: number, ...items: CourseModel[]): CourseModel[] {\n    const group = this.getCourseGroupById(droppableId);\n    if (!group) return [];\n\n    if (deleteCount) {\n      return group.courses.splice(start, deleteCount, ...items)\n    } else {\n      return group.courses.splice(start, 0, ...items);\n    }\n  }\n\n  //#region currentDraggableProps\n\n  private _currentDraggableProps: ICurrentDraggableProps = {\n    isDragging: false,\n    possibleTerms: [],\n    prerequisiteCourseIds: new Set<string>(),\n  }\n\n  get currentDraggableProps(): ICurrentDraggableProps {\n    return { ...this._currentDraggableProps }\n  }\n\n  set currentDraggableProps(props: ICurrentDraggableProps) {\n    this._currentDraggableProps = props;\n  }\n\n  clearCurrentDraggableProps(): void {\n    this.currentDraggableProps = {\n      isDragging: false,\n      possibleTerms: [],\n      prerequisiteCourseIds: new Set<string>(),\n    }\n  }\n\n  //#endregion\n\n}\n","import { ConditionalTree, isAndConditionalTree, isOrConditionalTree } from \"../interfaces/ModelInterfaces\";\n\n\nexport const conditionalTreeTraverser = (\n  treeNode: ConditionalTree,\n  fnIsLeafValid: (treeNode: ConditionalTree) => boolean,\n): string[] => {\n  let invalidations: string[] = [];\n\n  if (isOrConditionalTree(treeNode)) {\n    for (let childNode of treeNode.or) {\n      let result = conditionalTreeTraverser(childNode, fnIsLeafValid)\n      if (result.length === 0) {\n        invalidations = []\n        break\n      }\n      invalidations.push(...result)\n    }\n  } else if (isAndConditionalTree(treeNode)) {\n    treeNode.and.forEach(childNode => {\n      invalidations.push(...conditionalTreeTraverser(childNode, fnIsLeafValid))\n    })\n  } else if (!fnIsLeafValid(treeNode)) {\n    invalidations.push(treeNode)\n  }\n  // console.log(treeNode)\n  // console.log(invalidations)\n  return invalidations\n}\n","import { action, makeAutoObservable, reaction, transaction, when } from \"mobx\";\nimport { conditionalTreeTraverser } from '../helpers/ConditionalTreeTraverser';\nimport { ConditionalTree, StudyLevel } from \"../interfaces/ModelInterfaces\";\nimport { CourseModel, CourseStatus } from \"../models/CourseModel\";\nimport { SerializedCourseState, ISerializableEntity, TermtanglesSerialized } from \"../interfaces/SerializableInterfaces\"\nimport { TermModel } from \"../models/TermModel\";\nimport { getCourseValidations } from \"../models/Validations/Validations\";\nimport { UserState } from \"./UserState\";\nimport axios from \"axios\"\n\nexport class CourseState implements ISerializableEntity {\n  constructor(\n    private _userState: UserState\n  ) {\n    makeAutoObservable(this)\n    reaction(\n      () => this._userState.studyLevel,\n      () => {\n        this._isUpdated = false;\n        this._updateStudyLevel()\n          // .then(() => {\n          //   // this.getCourseById(\"COMP1511\")?.setCompleted()\n    \n          //   this.getCourseById(\"COMP1521\")?.setPlanned()\n    \n          //   this.getCourseById(\"COMP3231\")?.setPlanned()\n          //   let COMP9444 = this.getCourseById(\"COMP9444\")\n          //   if (COMP9444) {\n          //     this.assignCourseToTerm(COMP9444, new TermModel(2021, \"Term 3\"))\n          //   }\n          //   let MATH1081 = this.getCourseById(\"MATH1081\")\n          //   if (MATH1081) {\n          //     this.assignCourseToTerm(MATH1081, new TermModel(2021, \"Term 2\"))\n          //   }\n          //   let COMP2041 = this.getCourseById(\"COMP2041\")\n          //   if (COMP2041) {\n          //     this.assignCourseToTerm(COMP2041, new TermModel(2021, \"Term 2\"))\n          //   }\n          //   let COMP9417 = this.getCourseById(\"COMP9417\")\n          //   if (COMP9417) {\n          //     this.assignCourseToTerm(COMP9417, new TermModel(2022, \"Term 3\"))\n          //   }\n          //   let MATH1231 = this.getCourseById(\"MATH1231\")\n          //   if (MATH1231) {\n          //     this.assignCourseToTerm(MATH1231, new TermModel(2021, \"Term 3\"))\n          //   }\n          // })\n      },\n      { fireImmediately: true }\n    );\n    _userState.registerStudyLevelUpdateActionCallback(() => Promise.resolve(this._updateStudyLevel()));\n  }\n\n  private validations = getCourseValidations(this)\n\n  private coursesMapById = new Map<string, CourseModel>();\n\n  private coursesMapByActiveStatus = new Map<CourseStatus, Map<string, CourseModel>>();\n\n  private _isUpdated: boolean = false;\n\n  get isUpdated(): boolean {\n    return this._isUpdated;\n  }\n\n  get allCourses() {\n    return [...this.coursesMapById.values()]\n  }\n\n  private _resetCourseMap() {\n    this.coursesMapById = new Map<string, CourseModel>();\n    this.coursesMapByActiveStatus = new Map<CourseStatus, Map<string, CourseModel>>();\n    this.coursesMapByActiveStatus.set(CourseStatus.UNPLANNED, new Map<string, CourseModel>());\n    this.coursesMapByActiveStatus.set(CourseStatus.PLANNED, new Map<string, CourseModel>());\n    this.coursesMapByActiveStatus.set(CourseStatus.ALLOCATED, new Map<string, CourseModel>());\n    this.coursesMapByActiveStatus.set(CourseStatus.COMPLETED, new Map<string, CourseModel>());\n  }\n\n  private async _loadAllCourses(studyLevel: StudyLevel) {\n    return axios.get(`https://raw.githubusercontent.com/termtangles/termtangles_data/main/publish/${studyLevel.toString()}/all_courses.json`)\n      .then(response => {\n        transaction(() => {\n          this._resetCourseMap()\n          response.data.forEach(courseObj => {\n            let course = new CourseModel(\n              courseObj.code,\n              courseObj.contentTypeLabel,\n              courseObj.corequisites,\n              courseObj.creditPoints,\n              courseObj.description,\n              courseObj.effectiveDate,\n              courseObj.enrolmentRules,\n              courseObj.exclusion,\n              courseObj.facultyName,\n              courseObj.implementationYear,\n              courseObj.keywords,\n              courseObj.prerequisites,\n              courseObj.schoolName,\n              courseObj.studyLevel,\n              courseObj.termOffering,\n              courseObj.title,\n              courseObj.urlMap,\n            )\n\n            this.addCourse(course)\n          })\n        })\n    });\n  }\n\n  private async _updateStudyLevel() {\n    await this._loadAllCourses(this._userState.studyLevel);\n    this._isUpdated = true;\n  }\n\n  get termCourseMap(): Map<string, CourseModel[]> {\n    // console.log('running mapping')\n    let mapping = new Map<string, CourseModel[]>();\n    this.coursesMapByActiveStatus.get(CourseStatus.ALLOCATED)?.forEach(course => {\n      if (!course.allocatedTerm) {\n        return;\n      }\n      let courseList = mapping.get(course.allocatedTerm.getMappingName)\n      if (!courseList) {\n        mapping.set(course.allocatedTerm.getMappingName, [course])\n      } else {\n        courseList.push(course)\n      }\n    })\n    return mapping\n  }\n\n  get completedCourses(): CourseModel[] {\n    return [...this.coursesMapByActiveStatus.get(CourseStatus.COMPLETED)?.values() ?? []]\n  }\n\n  get plannedCourses(): CourseModel[] {\n    return [...this.coursesMapByActiveStatus.get(CourseStatus.PLANNED)?.values() ?? []]\n  }\n\n  get allocatedCourses(): CourseModel[] {\n    return [...this.coursesMapByActiveStatus.get(CourseStatus.ALLOCATED)?.values() ?? []]\n  }\n\n  get activeCourses(): CourseModel[] {\n    let allCourses: CourseModel[] = [];\n    allCourses = allCourses.concat(this.completedCourses, this.plannedCourses, this.allocatedCourses);\n    return allCourses;\n  }\n\n  get getMaxAllocatedYear(): number {\n    const uniqueTerms = [...this.termCourseMap.keys()]\n    let maxYear = new Date().getFullYear()\n    if (uniqueTerms.length > 0) {\n      maxYear = TermModel.fromMappingName(uniqueTerms.sort().slice(-1)[0]).year\n    }\n    return maxYear\n  }\n\n  getCourseById(id: string): CourseModel | undefined {\n    return this.coursesMapById.get(id)\n  }\n\n  addCourse(course: CourseModel) {\n    this.coursesMapById.set(course.id, course);\n    reaction(() => course.courseStatus, () => {\n      for (let courseStatusEnum in CourseStatus) {\n        if (!isNaN(Number(courseStatusEnum))) continue\n        const courseStatus: CourseStatus = CourseStatus[courseStatusEnum as keyof typeof CourseStatus]\n        if (courseStatus !== course.courseStatus) {\n          this.coursesMapByActiveStatus.get(courseStatus)?.delete(course.id)\n        } else {\n          this.coursesMapByActiveStatus.get(courseStatus)?.set(course.id, course)\n        }\n      }\n    }, {\n      fireImmediately: true,\n    })\n\n    reaction(() => course.courseStatus, () => {\n      this.runValidations();\n    }, {\n      fireImmediately: true,\n    })\n\n    reaction(() => course.allocatedTerm, () => {\n      this.runValidations();\n    }, {\n      fireImmediately: true,\n    })\n  }\n\n  runValidations() {\n    transaction(() => {\n      this.coursesMapByActiveStatus.get(CourseStatus.PLANNED)?.forEach(_course => {\n        _course.clearErrors()\n        this.validations.forEach(fnValidate => {\n          fnValidate(_course)\n        })\n      })\n      this.coursesMapByActiveStatus.get(CourseStatus.ALLOCATED)?.forEach(_course => {\n        _course.clearErrors()\n        this.validations.forEach(fnValidate => {\n          fnValidate(_course)\n        })\n      })\n      this.coursesMapByActiveStatus.get(CourseStatus.COMPLETED)?.forEach(_course => {\n        _course.clearErrors()\n      })\n    })\n  }\n\n  private resetHard() {\n    [...this.coursesMapById.values()].forEach((course) => {\n      course.setUnplanned();\n    });\n  }\n\n  getFlattenedPrerequisiteList(prerequisiteTree: ConditionalTree) {\n    return conditionalTreeTraverser(prerequisiteTree, (treeNode: ConditionalTree) => {\n      return false\n    })\n  }\n\n  getMissingPrerequisitesBeforeTerm(prerequisiteTree: ConditionalTree, term: TermModel) {\n    return conditionalTreeTraverser(prerequisiteTree, (treeNode: ConditionalTree) => {\n      if (typeof (treeNode) === 'string') {\n        const courseCode: string = treeNode;\n        const course = this.getCourseById(courseCode)\n\n        return course\n          ? ((course.courseStatus === CourseStatus.ALLOCATED && course.allocatedTerm?.isBefore(term))\n            || course.courseStatus === CourseStatus.COMPLETED)\n          : false\n      }\n      return true\n    })\n  }\n\n  getMissingPrerequisitesPlanned(prerequisiteTree: ConditionalTree) {\n    return conditionalTreeTraverser(prerequisiteTree, (treeNode: ConditionalTree) => {\n      if (typeof (treeNode) === 'string') {\n        const courseCode: string = treeNode;\n        const course = this.getCourseById(courseCode)\n        return course\n          ? course.courseStatus !== CourseStatus.UNPLANNED\n          : false\n      }\n      return true\n    })\n  }\n\n  courseIsOffered(term: TermModel, termOffering: string[]): boolean {\n    for (let i = 0; i < termOffering.length; i++) {\n      if (term.getTermName === termOffering[i]) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  getMissingRequirementsWhenAssigningCourseToTerm(course: CourseModel, term: TermModel): string[] {\n    let resp: string[] = this.getMissingPrerequisitesBeforeTerm(course.prerequisites, term)\n\n    // term = current term input, termOffering = List of avaliable terms\n    if (!this.courseIsOffered(term, course.termOffering)) {\n      resp.push(`Course is not offered in ${term.getFullName}`)\n    }\n\n    return resp\n  }\n\n  assignCourseToTerm(course: CourseModel, term: TermModel): boolean {\n    const invalidations = this.getMissingRequirementsWhenAssigningCourseToTerm(course, term)\n    if (invalidations.length === 0) {\n      course.setAllocated(term)\n      return true\n    }\n\n    return false\n  }\n\n  serialize(): SerializedCourseState {\n    return {\n      courses: this.activeCourses.map((courseModel) => {\n        return courseModel.serialize();\n      })\n    }\n  }\n\n  async deserialize(json: TermtanglesSerialized): Promise<void> {\n    if (!json.courseState) {\n      return;\n    }\n\n    const serializedCourseState = json.courseState;\n    if (!serializedCourseState.courses) {\n      return;\n    }\n\n    await when(() => { return this._isUpdated; })\n\n    this.resetHard();\n\n    serializedCourseState.courses.forEach((serializedCourse) => {\n      if (!serializedCourse.id) return;\n\n      const courseModel = this.getCourseById(serializedCourse.id);\n      if (courseModel) {\n        courseModel.deserialize(serializedCourse);\n      } else {\n        console.error(`ERROR: ${serializedCourse.id} is not a valid course.`);\n      }\n    });\n  }\n}\n","import { ErrorCode } from \"../../interfaces/ModelInterfaces\"\nimport { CourseState } from \"../../states/CourseState\"\nimport { CourseModel, CourseStatus } from \"../CourseModel\"\n\nexport const getCourseValidations = (courseState: CourseState): ((course: CourseModel) => void)[] => {\n  const validations = [\n    (course: CourseModel) => {\n      // console.log(`Running validation COURSE_NOT_OFFERED_IN_SELECTED_TERM on course ${course.code}`)\n      if (course.allocatedTerm && !course.termOffering.includes(course.allocatedTerm.getTermName)) {\n        course.addError({\n          code: ErrorCode.COURSE_NOT_OFFERED_IN_SELECTED_TERM,\n          message: `This course is not offered in ${course.allocatedTerm.getTermName}`,\n          missing: \"\"\n        })\n      }\n    },\n    (course: CourseModel) => {\n      // console.log(`Running validation PREREQUISITE_REQUIREMENT_NOT_MET on course ${course.code}`)\n      if (course.allocatedTerm) {\n        let missing = courseState.getMissingPrerequisitesBeforeTerm(course.prerequisites, course.allocatedTerm)\n        if (missing.length > 0) {\n          course.addError({\n            code: ErrorCode.PREREQUISITE_REQUIREMENT_NOT_MET,\n            message: `The prerequisites for this course are not satisfied\\n${course.enrolmentRules.join(\";\")}`,\n            missing: `Missing: ${missing}`\n          })\n        }\n      }\n    },\n    (course: CourseModel) => {\n      // console.log(`Running validation PREREQUISITES_NOT_PLANNED on course ${course.code}`)\n      if (course.courseStatus !== CourseStatus.ALLOCATED) {\n        let missing = courseState.getMissingPrerequisitesPlanned(course.prerequisites)\n        if (missing.length > 0) {\n          course.addError({\n            code: ErrorCode.PREREQUISITES_NOT_PLANNED,\n            message: `A valid combination of prerequisites for this course have not been planned\\n${course.enrolmentRules.join(\";\")}`,\n            missing: `Missing: ${missing}`\n          })\n        }\n      }\n    },\n    (course: CourseModel) => {\n      // console.log(`Running validation EXCLUSION_COURSE_CONFLICT on course ${course.code}`)\n      let conflictingExclusionCourses: string[] = []\n      course.exclusion.forEach((exclusionCourseCode) => {\n        let exclusionCourse = courseState.getCourseById(exclusionCourseCode)\n        if (exclusionCourse && exclusionCourse.courseStatus !== CourseStatus.UNPLANNED) {\n          conflictingExclusionCourses.push(exclusionCourseCode)\n        }\n      })\n      if (conflictingExclusionCourses.length > 0) {\n        course.addError({\n          code: ErrorCode.EXCLUSION_COURSE_CONFLICT,\n          message: `The following exclusion courses conflict with this course ${conflictingExclusionCourses.join(\", \")}`,\n          missing: \"\"\n        })\n      }\n    }\n  ]\n  return validations\n}\n","import { ICurriculumContainer, ICurriculumElement } from \"../interfaces/ModelInterfaces\";\nimport {v4 as uuidv4} from 'uuid';\n\nexport class CurriculumContainer implements ICurriculumContainer {\n    public readonly id: string = uuidv4();\n    constructor(\n        public readonly title: string,\n        public readonly description: string,\n        public readonly creditPoints: number,\n        public readonly elements: ICurriculumElement[],\n        public readonly containers: ICurriculumContainer[],\n        public readonly order: number,\n    ) {\n    }\n\n    toString() {\n        return this.title + ', ' + this.description;\n    }\n}\n\nexport class CurriculumElement implements ICurriculumElement {\n    constructor(\n        public readonly name: string,\n        public readonly description: string,\n        public readonly type: string,\n        public readonly creditPoints: number,\n        public readonly itemCode: string,\n        public readonly url: string,\n        public readonly order: number,\n    ) { }\n\n    public isCourse(): boolean {\n        return this.type.toLowerCase() === \"course\"\n    }\n\n    public isSpecialisation(): boolean {\n        return [\"major\", \"minor\", \"specialisation\", \"honours\"].includes(this.type.toLowerCase())\n    }\n\n    toString() {\n        return this.name + ', ' + this.type;\n    }\n}\n\n// Arg: Array of json data where each json contains data for Children Obj\nexport const parseCurriculumContainers = (childrenData: Array<any>): Array<CurriculumContainer> => {\n    let rootContainerList: CurriculumContainer[] = [];\n    \n    childrenData.forEach((data) => {\n        let childContainerList: CurriculumContainer[] = [];\n        let elementList: CurriculumElement[] = [];\n        // If nested children containers exist, recursively transform jsonData \n        // into Children obj\n        if (data.children.length > 0) {\n            childContainerList = parseCurriculumContainers(data.children);\n        }\n\n        if (data.relationships.length > 0) {\n            elementList = parseCurriculumElements(data.relationships);\n        }\n\n        let container = new CurriculumContainer(\n            data.title,\n            data.description,\n            Number(data.creditPoints),\n            elementList,\n            childContainerList,\n            Number(data.order)\n        );\n\n        rootContainerList.push(container);\n    })\n\n    return rootContainerList;\n}\n\n// Arg: Array of json data where each json contains data for Relationship obj\nexport const parseCurriculumElements = (relationData: Array<any>): Array<CurriculumElement> => {\n    let relationshipList: CurriculumElement[] = [];\n\n    relationData.forEach((data) => {\n        let relationshipObj = new CurriculumElement(\n            data.name,\n            data.description,\n            data.type,\n            Number(data.creditPoints),\n            data.itemCode,\n            data.url,\n            Number(data.order)\n        )\n\n        relationshipList.push(relationshipObj);\n    })\n\n    return relationshipList;\n}\n","import { makeAutoObservable } from 'mobx';\nimport { ICurriculumContainer, IProgram, IProgressionEntity, ProgressionStatus } from '../interfaces/ModelInterfaces';\nimport { SerializedProgram, ISerializableEntity } from \"../interfaces/SerializableInterfaces\"\n\nexport class ProgramModel implements IProgram, IProgressionEntity, ISerializableEntity {\n  public readonly id: string\n  public progressionStatus: ProgressionStatus = ProgressionStatus.UNPLANNED\n\n  constructor(\n    public readonly code: string,\n    public readonly title: string,\n    public readonly academicItemType: string,\n    public readonly additionalInfo: string,\n    public readonly creditPoints: number,\n    public readonly structureSummary: string,\n    public readonly curriculumStructure: Array<ICurriculumContainer>,\n    public readonly description: string,\n    public readonly facultyName: string,\n    public readonly implementationYear: number,\n    public readonly intakePeriod: Array<string>,\n    public readonly programConstraints: Array<any>,\n    public readonly schoolName: string,\n    public readonly studyLevel: string,\n    public readonly urlMap: string,\n  ) {\n    this.id = code\n    makeAutoObservable(this)\n  }\n\n  setPlanned() {\n    this.progressionStatus = ProgressionStatus.PLANNED\n  }\n\n  setUnplanned() {\n    this.progressionStatus = ProgressionStatus.UNPLANNED\n  }\n\n  serialize(): SerializedProgram {\n    return {\n      id: this.code,\n    };\n  }\n\n  async deserialize(program: SerializedProgram): Promise<void> {\n    if (program.id !== this.id) {\n      console.error(`ERROR: This program is not ${program.id} (is: ${this.id})`);\n      return;\n    }\n    \n    this.setPlanned();\n  }\n\n  toString() {\n    return `[PROGRAM_${this.id}] ${this.code} - ${this.title}`;\n  }\n}\n\n// export function loadProgramByCode(programCode: string) {\n//     return db.collection(\"programs\")\n//         .doc(programCode)!\n//         .withConverter(programConverter)\n//         .get().then((doc) => {\n//             if (doc.exists) {\n//                 var program = doc.data()!;\n\n//                 return program;\n//             } else {\n//                 console.log(\"No such document!\");\n//             }\n//         }).catch((error) => {\n//             console.log(\"Error getting document:\", error);\n//             throw new Error();\n//         });\n// }\n\n// let programConverter = {\n//     toFirestore: function (program) {\n//         return {\n//             name: program.code,\n//         };\n//     },\n//     fromFirestore: function (snapshot, options) {\n//         const data = snapshot.data(options);\n\n//         return new ProgramModel(\n//             data.academicItemType,\n//             data.additionalInformation,\n//             data.code,\n//             Number(data.creditPoints),\n//             parseCurriculumContainers(data.curriculumStructure),\n//             data.description,\n//             data.facultyName,\n//             Number(data.implementationYear),\n//             data.intakePeriod,\n//             data.programConstraints,\n//             data.schoolName,\n//             data.studyLevel,\n//             data.title,\n//             data.urlMap\n//         );\n//     }\n// };","import { makeAutoObservable } from 'mobx';\nimport { ICurriculumContainer, IProgressionEntity, ISpecialisation, ProgressionStatus } from '../interfaces/ModelInterfaces';\nimport { SerializedSpecialisation, ISerializableEntity } from \"../interfaces/SerializableInterfaces\"\n\nexport class SpecialisationModel implements ISpecialisation, IProgressionEntity, ISerializableEntity {\n  public readonly id: string\n  public progressionStatus: ProgressionStatus = ProgressionStatus.UNPLANNED\n\n  constructor(\n    public readonly code: string,\n    public readonly title: string,\n    public readonly academicItemType: string,\n    public readonly creditPoints: number,\n    public readonly structureSummary: string,\n    public readonly curriculumStructure: Array<ICurriculumContainer>,\n    public readonly description: string,\n    public readonly facultyName: string,\n    public readonly implementationYear: number,\n    public readonly keywords: string[],\n    public readonly schoolName: string,\n    public readonly studyLevel: string,\n    public readonly urlMap: string,\n  ) {\n    this.id = code\n    makeAutoObservable(this)\n  }\n\n  setPlanned() {\n    this.progressionStatus = ProgressionStatus.PLANNED\n  }\n\n  setUnplanned() {\n    this.progressionStatus = ProgressionStatus.UNPLANNED\n  }\n\n  serialize(): SerializedSpecialisation {\n    return {\n      id: this.code,\n    };\n  }\n\n  async deserialize(specialisation: SerializedSpecialisation) {\n    if (specialisation.id !== this.id) {\n      console.error(`ERROR: This specialisation is not ${specialisation.id} (is: ${this.id})`);\n      return;\n    }\n\n    this.setPlanned();   \n  }\n\n  toString() {\n    return `[SPECIALISATION_${this.id}] ${this.code} - ${this.title}`;\n  }\n}\n\n// export function loadSpecialisationByCode(specialisationCode: string) {\n//     return db.collection(\"specialisations\")\n//         .doc(specialisationCode)!\n//         .withConverter(specialisationConverter)\n//         .get().then((doc) => {\n//             if (doc.exists) {\n//                 var specialisation = doc.data()!;\n\n//                 return specialisation;\n//             } else {\n//                 console.log(\"No such document!\");\n//             }\n//         }).catch((error) => {\n//             console.log(\"Error getting document:\", error);\n//             throw new Error();\n//         });\n// }\n\n// let specialisationConverter = {\n//     toFirestore: function (specialisation) {\n//         return {\n//             name: specialisation.code,\n//         };\n//     },\n//     fromFirestore: function (snapshot, options) {\n//         const data = snapshot.data(options);\n\n//         return new SpecialisationModel(\n//             data.academicItemType,\n//             data.code,\n//             Number(data.creditPoints),\n//             parseCurriculumContainers(data.curriculumStructure),\n//             data.description,\n//             data.facultyName,\n//             Number(data.implementationYear),\n//             data.keywords,\n//             data.schoolName,\n//             data.studyLevel,\n//             data.title,\n//             data.urlMap,\n//         );\n//     }\n// };","import { action, makeAutoObservable, reaction, transaction, when } from \"mobx\";\nimport { IProgressionEntity, ProgressionStatus, StudyLevel } from \"../interfaces/ModelInterfaces\";\nimport { SerializedProgressionState, ISerializableEntity, TermtanglesSerialized } from \"../interfaces/SerializableInterfaces\"\nimport { parseCurriculumContainers } from \"../models/CurriculumModel\";\nimport { ProgramModel } from \"../models/ProgramModel\";\nimport { SpecialisationModel } from \"../models/SpecialisationModel\";\nimport { UserState } from \"./UserState\";\nimport axios from \"axios\"\n\nexport class ProgressionState implements ISerializableEntity {\n  constructor(\n    userState: UserState\n  ) {\n    makeAutoObservable(this)\n    this._userState = userState\n    reaction(\n      () => this._userState.studyLevel,\n      () => {\n        this._isUpdated = false;\n        this._updateStudyLevel()\n      },\n      { fireImmediately: true }\n    )\n    userState.registerStudyLevelUpdateActionCallback(() => Promise.resolve(this._updateStudyLevel()));\n  }\n\n  private _userState: UserState\n  private _programMapById = new Map<string, ProgramModel>();\n  private _specialisationMapById = new Map<string, SpecialisationModel>();\n  private _isUpdated: boolean = false;\n\n  get isUpdated(): boolean {\n    return this._isUpdated;\n  }\n\n  private _updateStudyLevel = async () => {\n    await this.loadAllPrograms(this._userState.studyLevel);\n    await this.loadAllSpecialisations(this._userState.studyLevel);\n    this._isUpdated = true;\n  };\n\n  get allPrograms() {\n    return [...this._programMapById.values()]\n  }\n\n  get allSpecialisations() {\n    return [...this._specialisationMapById.values()]\n  }\n\n  getProgramById(id: string) {\n    return this._programMapById.get(id)\n  }\n\n  getSpecialisationById(id: string) {\n    return this._specialisationMapById.get(id)\n  }\n\n  get plannedPrograms(): ProgramModel[] {\n    return this.allPrograms.filter(program => program.progressionStatus === ProgressionStatus.PLANNED)\n  }\n\n  get plannedSpecialisations(): SpecialisationModel[] {\n    return this.allSpecialisations.filter(specialisation => specialisation.progressionStatus === ProgressionStatus.PLANNED)\n  }\n\n  get plannedProgressionEntities(): IProgressionEntity[] {\n    let result: IProgressionEntity[] = this.plannedPrograms\n    result = result.concat(this.plannedSpecialisations)\n    return result\n  }\n\n  private resetHard(): void {\n    this._programMapById.forEach((program) => {\n      program.setUnplanned();\n    });\n    this._specialisationMapById.forEach((specialisation) => {\n      specialisation.setUnplanned();\n    });\n  }\n\n  addProgram(program: ProgramModel) {\n    this._programMapById.set(program.id, program)\n  }\n  addSpecialisation(specialisation: SpecialisationModel) {\n    this._specialisationMapById.set(specialisation.id, specialisation)\n  }\n\n  serialize(): SerializedProgressionState {\n    return {\n      programs: this.plannedPrograms.map((programModel) => {\n        return programModel.serialize();\n      }),\n      specialisations: this.plannedSpecialisations.map((specialisationModel) => {\n        return specialisationModel.serialize();\n      }),\n    }\n  }\n\n  async deserialize(json: TermtanglesSerialized) {\n    if (!json.progressionState) {\n      return;\n    }\n\n    await when(() => { return this._isUpdated; });\n\n    this.resetHard();\n    const serializedProgressionState = json.progressionState;\n    if (serializedProgressionState.programs) {\n      serializedProgressionState.programs.forEach((serializedProgram) => {\n        if (!serializedProgram.id) return;\n\n        const programModel = this.getProgramById(serializedProgram.id);\n        if (programModel) {\n          programModel.deserialize(serializedProgram);\n        } else {\n          console.error(`ERROR: ${serializedProgram.id} is not a valid program.`);\n        }\n      });\n    }\n    if (serializedProgressionState.specialisations) {\n      serializedProgressionState.specialisations.forEach((serializedSpecialisation) => {\n        if (!serializedSpecialisation.id) return;\n\n        const specialisationModel = this.getSpecialisationById(serializedSpecialisation.id);\n        if (specialisationModel) {\n          specialisationModel.deserialize(serializedSpecialisation);\n        } else {\n          console.error(`ERROR: ${serializedSpecialisation.id} is not a valid specialisation.`);\n        }\n      });\n    }\n  }\n\n  private loadAllPrograms = action((studyLevel: StudyLevel) => {\n    return axios.get(`https://raw.githubusercontent.com/termtangles/termtangles_data/main/publish/${studyLevel.toString()}/all_programs.json`)\n    .then(response => {\n      transaction(() => {\n        this._programMapById.clear()\n        response.data.forEach(programObj => {\n          let program = new ProgramModel(\n            programObj.code,\n            programObj.title,\n            programObj.academicItemType,\n            programObj.additionalInfo,\n            programObj.creditPoints,\n            programObj.structureSummary,\n            parseCurriculumContainers(programObj.curriculumStructure),\n            programObj.description,\n            programObj.facultyName,\n            programObj.implementationYear,\n            programObj.intakePeriod,\n            programObj.programConstraints,\n            programObj.schoolName,\n            programObj.studyLevel,\n            programObj.urlMap\n          )\n\n          this.addProgram(program);\n        })\n      })\n    })\n  })\n\n  private loadAllSpecialisations = action((studyLevel: StudyLevel) => {\n    return axios.get(`https://raw.githubusercontent.com/termtangles/termtangles_data/main/publish/${studyLevel.toString()}/all_specialisations.json`)\n      .then(response => {\n        transaction(() => {\n          this._specialisationMapById.clear()\n          response.data.forEach(specialisationObj => {\n            let specialisation = new SpecialisationModel(\n              specialisationObj.code,\n              specialisationObj.title,\n              specialisationObj.academicItemType,\n              specialisationObj.creditPoints,\n              specialisationObj.structureSummary,\n              parseCurriculumContainers(specialisationObj.curriculumStructure),\n              specialisationObj.description,\n              specialisationObj.facultyName,\n              specialisationObj.implementationYear,\n              specialisationObj.keywords,\n              specialisationObj.schoolName,\n              specialisationObj.studyLevel,\n              specialisationObj.urlMap,\n            )\n\n            this.addSpecialisation(specialisation);\n          })\n        })\n    })\n  });\n}\n\n","import { CourseModel } from '../models/CourseModel';\r\nimport { ProgramModel } from '../models/ProgramModel';\r\nimport { SpecialisationModel } from '../models/SpecialisationModel';\r\nimport { CourseState } from './CourseState';\r\nimport { ProgressionState } from './ProgressionState';\r\n\r\n\r\nexport class SearchDataState {\r\n  constructor(\r\n    private _courseState: CourseState,\r\n    private _progressionState: ProgressionState,\r\n  ) {}\r\n\r\n  get courseSearchData(): CourseModel[] {\r\n    return this._courseState.allCourses.sort((a, b) => (a.code > b.code) ? 1 : -1)\r\n  }\r\n  get programSearchData(): ProgramModel[] {\r\n    return this._progressionState.allPrograms.sort((a, b) => (a.title > b.title) ? 1 : -1)\r\n  }\r\n  get specialisationSearchData(): SpecialisationModel[] {\r\n    return this._progressionState.allSpecialisations.sort((a, b) => (a.title > b.title) ? 1 : -1)\r\n  }\r\n}\r\n","import { makeAutoObservable, when } from \"mobx\";\nimport { StudyLevel } from \"../interfaces/ModelInterfaces\";\nimport { SerializedUserState, ISerializableEntity, TermtanglesSerialized } from \"../interfaces/SerializableInterfaces\"\n\nconst stringToStudyLevelMap = ((str: string) => {\n  switch(str) {\n    case \"undergraduate\": return StudyLevel.UNDERGRADUATE;\n    case \"postgraduate\": return StudyLevel.POSTGRADUATE;\n    case \"research\": return StudyLevel.RESEARCH;\n    default: return undefined;\n  }\n});\n\nexport class UserState implements ISerializableEntity {\n  constructor() {\n    makeAutoObservable(this)\n  }\n\n  private _studyLevel: StudyLevel = StudyLevel.UNDERGRADUATE\n  private _isUpdated: boolean = true;\n  private _studyLevelUpdateActionCallbacks: (() => Promise<void>)[] = [];\n\n  get studyLevel() {\n    return this._studyLevel\n  }\n\n  async setStudyLevel (studyLevel: StudyLevel) {\n    if (this._studyLevel !== studyLevel) {\n      this._studyLevel = studyLevel;\n      const studyLevelPromises: Promise<void>[] = this._studyLevelUpdateActionCallbacks.map(callback => callback());\n      return Promise.all(studyLevelPromises);\n    }\n  }\n\n  set isUpdated(isUpdated: boolean) {\n    this._isUpdated = isUpdated;\n  }\n  \n  get isUpdated(): boolean {\n    return this._isUpdated;\n  }\n\n  registerStudyLevelUpdateActionCallback(updateAction: () => Promise<void>) {\n    this._studyLevelUpdateActionCallbacks.push(updateAction);\n  }\n\n  serialize(): SerializedUserState {\n    return {studyLevel: this._studyLevel};\n  }\n\n  async deserialize(json: TermtanglesSerialized): Promise<void> {\n    if (!json.userState) {\n      throw \"ERROR: User state not included.\";\n    }\n\n    const serializedUserState = json.userState;\n    if (!serializedUserState.studyLevel) {\n      throw `ERROR: User state must include a studyLevel parameter.`;\n    }\n\n    const level = stringToStudyLevelMap(serializedUserState.studyLevel);\n    if (!level) {\n      throw `ERROR: ${serializedUserState.studyLevel} is not a valid study level.`\n    }\n\n    await this.setStudyLevel(level);\n  }\n}\n","import { createContext } from 'react'\nimport { CourseState } from '../states/CourseState'\nimport { ProgressionState } from '../states/ProgressionState';\nimport { SearchDataState } from '../states/SearchDataState';\nimport { UserState } from '../states/UserState';\n\nconst userState = new UserState();\nconst courseState = new CourseState(userState);\nconst progressionState = new ProgressionState(userState);\nconst searchDataState = new SearchDataState(courseState, progressionState);\n\nexport const ApplicationContext = createContext({\n    userState,\n    courseState,\n    progressionState,\n    searchDataState,\n})\n","\nimport { Grid, Item, Pagination } from 'semantic-ui-react'\nimport styled from 'styled-components'\n\nexport const ResultItem = styled(Item)`\n  &&& {\n    border: 0px solid lightgrey;\n    padding: 6px;\n    display: flex;\n    align-items: flex-start;\n    justify-content: space-between;\n    margin:0px\n  }\n  &&&&{\n    padding:1em 0;\n  }\n`\n\nexport const ResultItemHeader = styled(Item.Header)`\n`\n\nexport const ResultItemContent = styled(Item.Content)`\n  &&&&& {\n    flex: 1;\n    padding:0;\n  }\n`\n\nexport const ResultItemExtra = styled(Item.Extra)`\n  &&&& {\n    margin: 0;\n    text-align: right;\n    flex: 1;\n  }\n`\n\nexport const ResultCollection = styled(Item.Group)`\n  && {\n    padding: 15px 0px 10px 0px;\n    margin: 0px;\n  }\n`\n\nexport const ResultsPagination = styled(Pagination)`\n  max-height: 40px;\n`\n\nexport const ResultsColumn = styled(Grid.Column)`\n`\n\n","import { Observer, observer } from \"mobx-react\"\nimport { useState } from \"react\"\nimport { Button, Icon, Item } from \"semantic-ui-react\"\nimport { CourseModel, CourseStatus } from \"../../../models/CourseModel\"\nimport { ResultItem, ResultItemContent, ResultItemExtra, ResultItemHeader } from \"../SearchPanelStyles\"\n\nexport interface IResultViewProps<T> {\n  course: T\n}\n\nexport const CourseResultView = observer((props: IResultViewProps<CourseModel>) => {\n  const [showOptions, setShowOptions] = useState(false)\n\n  const openInNewTab = (url) => {\n    const newWindow = window.open(url, '_blank', 'noopener,noreferrer')\n    if (newWindow) newWindow.opener = null\n  }\n\n  return <Observer>\n    {\n      () => {\n        return (\n          <ResultItem\n            onMouseOver={() => setShowOptions(true)}\n            onMouseLeave={() => setShowOptions(false)}\n          >\n            <ResultItemContent>\n              <ResultItemHeader>{props.course.code}</ResultItemHeader>\n              <Item.Description>{props.course.title}</Item.Description>\n            </ResultItemContent>\n            {\n              !showOptions\n              ?\n                <ResultItemContent>\n                  <ResultItemExtra>{props.course.creditPoints} UOC</ResultItemExtra>\n                  <ResultItemExtra>\n                    {\n                      props.course.courseStatus === CourseStatus.PLANNED\n                        ? <Icon color=\"red\" className=\"bookmark\" />\n                        : props.course.courseStatus === CourseStatus.ALLOCATED\n                          ? <Icon color=\"orange\" className=\"calendar alternate outline\" />\n                          : props.course.courseStatus === CourseStatus.COMPLETED\n                            ? <Icon color=\"green\" className=\"check\" />\n                            : \"\"\n                    }\n\n                  </ResultItemExtra>\n                </ResultItemContent>\n                :\n                <ResultItemContent>\n                  <ResultItemExtra>\n                    <Button.Group>\n                      <Button\n                        basic = {props.course.courseStatus !== CourseStatus.PLANNED && props.course.courseStatus !== CourseStatus.ALLOCATED}\n                        icon={props.course.courseStatus === CourseStatus.ALLOCATED ? 'calendar alternate outline' : 'bookmark'}\n                        content={props.course.courseStatus === CourseStatus.ALLOCATED ? 'Scheduled' : 'Interested'}\n                        color={props.course.courseStatus === CourseStatus.ALLOCATED ? 'orange' : 'blue'}\n                        size=\"medium\"\n                        onClick= {() => {\n                          if (props.course.courseStatus === CourseStatus.PLANNED || props.course.courseStatus === CourseStatus.ALLOCATED) {\n                            props.course.setUnplanned()\n                          } else {\n                            props.course.setPlanned()\n                          }\n                        }}\n                      />\n                      <Button\n                        basic = {props.course.courseStatus !== CourseStatus.COMPLETED}\n                        icon='check'\n                        content='Done'\n                        color=\"green\"\n                        size=\"medium\"\n                        onClick= {() => {\n                          if (props.course.courseStatus === CourseStatus.COMPLETED) {\n                            props.course.setUnplanned()\n                          } else {\n                            props.course.setCompleted()\n                          }\n                        }}\n                      />\n                      <Button\n                        basic = {true}\n                        icon={'book'}\n                        content={'Handbook'}\n                        color={'red'}\n                        size=\"medium\"\n                        onClick= {() => openInNewTab(`https://www.handbook.unsw.edu.au${props.course.urlMap}`) }\n                      />\n                    </Button.Group>\n                  </ResultItemExtra>\n                </ResultItemContent>\n            }\n          </ResultItem>\n        )\n      }\n    }\n  </Observer>\n})\n","import { Observer, observer } from \"mobx-react\"\nimport React, { useState } from \"react\"\nimport { Button, Icon, Item } from \"semantic-ui-react\"\nimport { ProgressionStatus } from \"../../../interfaces/ModelInterfaces\"\nimport { SpecialisationModel } from \"../../../models/SpecialisationModel\"\nimport { ResultItem, ResultItemContent, ResultItemExtra } from \"../SearchPanelStyles\"\n\nexport interface IResultViewProps<T> {\n  specialisation: T\n}\n\nexport const SpecialisationResultView = observer((props: IResultViewProps<SpecialisationModel>) => {\n  const [showOptions, setShowOptions] = useState(false)\n\n  const openInNewTab = (url) => {\n    const newWindow = window.open(url, '_blank', 'noopener, noreferrer')\n    if (newWindow) newWindow.opener = null\n  }\n\n  return <Observer>\n    {\n      () => {\n        return (\n          <ResultItem\n            onMouseEnter={() => setShowOptions(true)}\n            onMouseLeave={() => setShowOptions(false)}\n          >\n            <ResultItemContent>\n              <Item.Header>{props.specialisation.title}</Item.Header>\n              <Item.Description>{props.specialisation.academicItemType} - {props.specialisation.code}</Item.Description>\n            </ResultItemContent>\n            {\n              !showOptions\n              ?\n                <ResultItemContent>\n                  <ResultItemExtra>{props.specialisation.creditPoints} UOC</ResultItemExtra>\n                  <ResultItemExtra>\n                    {\n                      props.specialisation.progressionStatus === ProgressionStatus.PLANNED\n                        ? <Icon color=\"green\" className=\"calendar alternate outline\" />\n                        : <></>\n                    }\n                  </ResultItemExtra>\n                </ResultItemContent>\n                :\n                <ResultItemContent>\n                  <ResultItemExtra>\n                    <Button.Group>\n                      <Button\n                        basic = {props.specialisation.progressionStatus === ProgressionStatus.UNPLANNED}\n                        icon={props.specialisation.progressionStatus === ProgressionStatus.UNPLANNED ? \"plus circle\" : \"minus circle\"}\n                        content={props.specialisation.progressionStatus === ProgressionStatus.UNPLANNED ? \"Add\" : \"Remove\"}\n                        color={props.specialisation.progressionStatus === ProgressionStatus.UNPLANNED ? \"green\" : \"red\"}\n                        size=\"medium\"\n                        onClick= {() => {\n                          if (props.specialisation.progressionStatus === ProgressionStatus.UNPLANNED) {\n                            props.specialisation.setPlanned()\n                          } else {\n                            props.specialisation.setUnplanned()\n                          }\n                        }}\n                      />\n                      <Button\n                        basic = {true}\n                        icon={'book'}\n                        content={'Handbook'}\n                        color={'red'}\n                        size=\"medium\"\n                        onClick= {() => openInNewTab(`https://www.handbook.unsw.edu.au${props.specialisation.urlMap}`) }\n                      />\n                    </Button.Group>\n                  </ResultItemExtra>\n                </ResultItemContent>\n            }\n          </ResultItem>\n        )\n      }\n    }\n  </Observer>\n})\n","import { Observer, observer } from \"mobx-react\";\nimport { ApplicationContext } from \"../../../contexts/ApplicationContext\";\nimport { CurriculumElement } from \"../../../models/CurriculumModel\";\nimport React, { useContext } from \"react\";\nimport { CourseResultView } from \"../../SearchPanel/Results/CourseResultView\";\nimport { SpecialisationResultView } from \"../../SearchPanel/Results/SpecialisationResultView\";\nimport { ResultCollection } from \"../../SearchPanel/SearchPanelStyles\";\n\nexport interface ICurriculumElementViewProps {\n  entityId: string,\n  curriculumElements: CurriculumElement[]\n}\n\nexport const CurriculumElementsView = observer((props: ICurriculumElementViewProps) => {\n  const applicationContext = useContext(ApplicationContext);\n  return <Observer>\n    {\n      () => {\n        return props.curriculumElements.length > 0\n          ? <ResultCollection divided>\n            {\n              props.curriculumElements\n                .sort((a, b) => Number(a.order) - Number(b.order))\n                .map(element => {\n                  if (element.isCourse()) {\n                    let course = applicationContext.courseState.getCourseById(element.itemCode)\n                    return course ? <CourseResultView course={course} /> : <></>\n                  } else if (element.isSpecialisation()) {\n                    let specialisation = applicationContext.progressionState.getSpecialisationById(element.itemCode)\n                    return specialisation ? <SpecialisationResultView specialisation={specialisation} /> : <></>\n                  }\n                  return <p>{element.description}</p>\n                })\n            }\n          </ResultCollection>\n          : <></>\n      }\n    }\n  </Observer>\n});\n","import parse from 'html-react-parser';\nimport { Observer, observer } from \"mobx-react\";\nimport React from \"react\";\nimport sanitizeHtml from 'sanitize-html';\nimport { Accordion, Icon, Label } from \"semantic-ui-react\";\nimport styled from 'styled-components';\nimport { CurriculumContainer } from \"../../../models/CurriculumModel\";\nimport { ProgressionPlannerViewModel } from \"../ProgressionPlannerViewModel\";\nimport { CurriculumElementsView } from \"./CurriculumElementsView\";\n\nexport interface ICurriculumContainerViewProps {\n  entityId: string\n  curriculumContainer: CurriculumContainer[]\n  progressionPlannerViewModel: ProgressionPlannerViewModel\n}\n\nexport const CurriculumAccordionCreditPoints = styled(Label)`\n  &&& {\n    margin-left:auto\n    \n  }\n`\n\nexport const CurriculumAccordionTitle = styled(Accordion.Title)`\n  &&& {\n    display:flex;\n  }\n`\nexport const CurriculumDescriptionDiv = styled.div`\n  display: flex;\n  justify-content: space-between;\n`\n\nexport const CurriculumExpandCollapseLink = styled.a`\n  min-width: 80px;\n  text-align: right;\n`\n\nexport const CurriculumContent = styled.div`\n  margin-left:10px;\n`\n\nexport const CurriculumContainerView = observer((props: ICurriculumContainerViewProps) => {\n  const getCreditPointsView = (container: CurriculumContainer) => {\n    const uocOfChildren = props.progressionPlannerViewModel.calculateUocOfChildren(container)\n    if (container.creditPoints > 0) {\n      return <CurriculumAccordionCreditPoints\n        size=\"small\"\n        color={uocOfChildren === container.creditPoints\n          ? \"green\"\n          : uocOfChildren < container.creditPoints\n            ? \"orange\"\n            : \"yellow\"\n        }\n      >\n        {uocOfChildren} / {container.creditPoints} UOC\n      </CurriculumAccordionCreditPoints>\n    } else if (uocOfChildren > 0) {\n      return <CurriculumAccordionCreditPoints\n        size=\"small\"\n        color=\"green\"\n      >\n        {uocOfChildren} UOC\n      </CurriculumAccordionCreditPoints>\n    }\n  }\n\n  return <Observer>\n    {\n      () => {\n        return props.curriculumContainer.length > 0\n          ? <Accordion.Accordion\n            key={props.entityId}\n            exclusive={false}\n            panels={[...props.curriculumContainer]\n              .sort((a, b) => Number(a.order) - Number(b.order))\n              .map(container => {\n                return {\n                  key: container.id,\n                  title: <CurriculumAccordionTitle>\n                    <Icon className={\n                      props.progressionPlannerViewModel.isContainerActive(container.id)\n                      ? \"caret down\"\n                      : \"caret right\"\n                    }/>\n                    {container.title}\n                    {getCreditPointsView(container)}\n                  </CurriculumAccordionTitle>,\n                  content: {\n                    content: <div>\n                      <CurriculumContent>\n                      <CurriculumDescriptionDiv>\n                        <span>{parse(sanitizeHtml(container.description))}</span>\n                        {\n                          container.containers.length > 0\n                            ? <CurriculumExpandCollapseLink\n                              href=\"#\"\n                              onClick={() => props.progressionPlannerViewModel.toggleAllContainers(container)}\n                            >\n                              {\n                                props.progressionPlannerViewModel.isAnySubContainerActive(container)\n                                  ? \"Collapse All\"\n                                  : \"Expand All\"\n                              }\n                            </CurriculumExpandCollapseLink>\n                            : <></>\n                        }\n                      </CurriculumDescriptionDiv>\n                      <CurriculumElementsView entityId={props.entityId} curriculumElements={container.elements} />\n                      </CurriculumContent>\n                      <CurriculumContainerView\n                        entityId={props.entityId}\n                        curriculumContainer={container.containers}\n                        progressionPlannerViewModel={props.progressionPlannerViewModel}\n                      />\n                    </div>\n                  },\n                  active: props.progressionPlannerViewModel.isContainerActive(container.id),\n                  onTitleClick: () => { props.progressionPlannerViewModel.toggleContainer(container.id) }\n                }\n              })}\n          />\n          : <></>\n      }\n    }\n  </Observer>\n});\n","import { Observer, observer } from 'mobx-react';\nimport React from 'react';\nimport { Accordion } from 'semantic-ui-react';\nimport styled from 'styled-components';\nimport { IProgressionEntity } from '../../interfaces/ModelInterfaces';\nimport { CurriculumContainerView } from './CurriculumView/CurriculumContainerView';\nimport { ProgressionPlannerViewModel } from './ProgressionPlannerViewModel';\nimport parse from 'html-react-parser';\nimport sanitizeHtml from 'sanitize-html';\n\nexport interface IProgressionEntityViewProps {\n  progressionPlannerViewModel: ProgressionPlannerViewModel\n  entity: IProgressionEntity\n}\n\nconst ProgressionEntityTitle = styled.a`\ncolor: black;\nbackground-color: transparent;\ntext-decoration: none;\n\n&:hover {\n  color: #db2828;\n  background-color: transparent;\n  text-decoration: line-through;\n}\n`\n\nconst ProgressionEntityView = observer((props: IProgressionEntityViewProps) => {\n  return <Observer>\n    {() => {\n      return <>\n        <h2>\n          <ProgressionEntityTitle\n            href=\"#\"\n            onClick={() => props.entity.setUnplanned()}\n          >{props.entity.title}</ProgressionEntityTitle>\n        </h2>\n        <span>{parse(sanitizeHtml(props.entity.structureSummary))}</span>\n        <Accordion fluid styled>\n          <CurriculumContainerView\n            entityId={props.entity.id}\n            curriculumContainer={props.entity.curriculumStructure}\n            progressionPlannerViewModel={props.progressionPlannerViewModel}\n          />\n        </Accordion>\n      </>\n    }}\n  </Observer>\n})\n\nexport default ProgressionEntityView;\n","import { Observer, observer } from 'mobx-react';\nimport React from 'react';\nimport { Container } from 'semantic-ui-react';\nimport styled from 'styled-components';\nimport ProgressionEntityView from './ProgressionEntityView';\nimport { ProgressionPlannerViewModel } from './ProgressionPlannerViewModel';\n\nexport const ProgressionContainer = styled(Container)`\n  margin:1em 0;\n`\n\nexport interface IProgressionPlannerProps {\n  progressionPlannerViewModel: ProgressionPlannerViewModel\n}\n\nconst ProgresionPlanner = observer(({ progressionPlannerViewModel }: IProgressionPlannerProps) => {\n  return <Observer>\n    {() => {\n      return (\n        <React.Fragment>\n          <ProgressionContainer>\n            {\n              progressionPlannerViewModel\n                .progressionState\n                .plannedProgressionEntities\n                .map(entity => {\n                  return <ProgressionEntityView\n                    entity={entity}\n                    progressionPlannerViewModel={progressionPlannerViewModel}\n                  />\n                })\n            }\n          </ProgressionContainer>\n        </React.Fragment>\n      )\n    }}\n  </Observer>\n})\n\nexport default ProgresionPlanner;\n","import { makeObservable, observable } from \"mobx\";\nimport { ProgressionStatus } from \"../../interfaces/ModelInterfaces\";\nimport { CourseStatus } from \"../../models/CourseModel\";\nimport { CurriculumContainer } from \"../../models/CurriculumModel\";\nimport { ProgramModel } from \"../../models/ProgramModel\";\nimport { SpecialisationModel } from \"../../models/SpecialisationModel\";\nimport { CourseState } from \"../../states/CourseState\";\nimport { ProgressionState } from \"../../states/ProgressionState\";\n\nexport interface IProgressionPlannerState {\n  id: string,\n  title: string,\n  programs: ProgramModel[],\n  specialisations: SpecialisationModel[],\n}\n\nexport class ProgressionPlannerViewModel {\n  private _progressionState: ProgressionState\n  private _courseState: CourseState\n  private _progressionPlannerState: IProgressionPlannerState\n  private _displayableContainerPanels: Set<string> = new Set<string>()\n\n  constructor(\n    progressionState: ProgressionState,\n    courseState: CourseState,\n  ) {\n    makeObservable<ProgressionPlannerViewModel,\n      \"_displayableContainerPanels\"\n    >(this, {\n      _displayableContainerPanels: observable,\n    })\n\n    this._progressionState = progressionState\n    this._progressionPlannerState = {\n      id: \"progressionPlanner\",\n      title: \"Progression Planner\",\n      programs: [],\n      specialisations: [],\n    }\n    this._courseState = courseState\n  }\n\n  get progressionState() {\n    return this._progressionState;\n  }\n\n  get progressionPlannerState() {\n    return this._progressionPlannerState;\n  }\n\n  calculateUocOfChildren(curriculumContainer: CurriculumContainer): number {\n    return [...this.getUniqueUocOfCurriculumContainer(curriculumContainer).values()].reduce((a, b) => a + b, 0)\n  }\n\n  getUniqueUocOfCurriculumContainer(curriculumContainer: CurriculumContainer): Map<string, number> {\n    let allChildren = new Map<string, number>()\n    curriculumContainer.elements.forEach(element => {\n      if (element.isCourse()) {\n        let course = this._courseState.getCourseById(element.itemCode)\n        if (course && course.courseStatus !== CourseStatus.UNPLANNED) {\n          allChildren.set(element.itemCode, element.creditPoints)\n        }\n      } else if (element.isSpecialisation()) {\n        let specialisation = this.progressionState.getSpecialisationById(element.itemCode)\n        if (specialisation && specialisation.progressionStatus !== ProgressionStatus.UNPLANNED) {\n          allChildren.set(element.itemCode, element.creditPoints)\n        }\n      }\n    })\n    curriculumContainer.containers.forEach(container => {\n      let childResult = this.getUniqueUocOfCurriculumContainer(container)\n      childResult.forEach((value, key) => allChildren.set(key, value))\n    })\n    return allChildren\n  }\n\n  toggleContainer(containerId: string) {\n    if (this._displayableContainerPanels.has(containerId)) {\n      this._displayableContainerPanels.delete(containerId)\n    } else {\n      this._displayableContainerPanels.add(containerId)\n    }\n  }\n\n  isAnySubContainerActive(rootContainer: CurriculumContainer): boolean {\n    return rootContainer.containers.filter(container => {\n      return this._displayableContainerPanels.has(container.id)\n        || this.isAnySubContainerActive(container)\n    }).length > 0\n  }\n\n  toggleAllContainers(rootContainer: CurriculumContainer) {\n    if (this.isAnySubContainerActive(rootContainer)) {\n      rootContainer.containers.forEach(container => {\n        this.setAllContainersInactive(container)\n      })\n    } else {\n      rootContainer.containers.forEach(container => {\n        this.setAllContainersActive(container)\n      })\n    }\n  }\n\n  private setAllContainersActive(rootContainer: CurriculumContainer) {\n    rootContainer.containers.forEach(container => {\n      this.setAllContainersActive(container)\n    })\n    this._displayableContainerPanels.add(rootContainer.id)\n  }\n\n  private setAllContainersInactive(rootContainer: CurriculumContainer) {\n    rootContainer.containers.forEach(container => {\n      this.setAllContainersInactive(container)\n    })\n    this._displayableContainerPanels.delete(rootContainer.id)\n  }\n\n  isContainerActive(containerId: string): boolean {\n    return this._displayableContainerPanels.has(containerId)\n  }\n}\n","import { makeAutoObservable } from \"mobx\";\nexport type FilterValue = string\n\nexport interface IFilterElementState {\n  filterElementName: string\n  numMatchingRecords: number\n}\n\nexport class FilterModel<T> {\n  private _possibleValues: Set<FilterValue> = new Set();\n  private _selectedValues: Set<FilterValue> = new Set();\n  constructor(\n    public readonly name: string,\n    private readonly fnGetTargetValue: (searchResult: T) => FilterValue[],\n  ) {\n    makeAutoObservable(this)\n  }\n\n  private filterResultMapping = new Map<string, number>();\n  public initializeFilter = (allSearchData: T[]) =>{\n    this._possibleValues = new Set(allSearchData\n      .map(result => this.fnGetTargetValue(result))\n      .flat()\n      .filter(value => value !== \"\")\n    )\n  }\n\n  public applyFilter = (searchResults: T[]): T[] => {\n    let results = searchResults\n    if (this._selectedValues.size > 0) {\n      results = searchResults\n        .filter(result => [...this._selectedValues.values()]\n          .filter(filterValue => this.fnGetTargetValue(result).includes(filterValue))\n          .length > 0\n        )\n    }\n    return results\n  }\n\n  public getFilterState(searchResults: T[]): IFilterElementState[] {\n    const isNumerical = [...this._possibleValues.values()].filter(value => isNaN(Number(value))).length === 0\n    return [...this._possibleValues.values()]\n      .sort((a, b) => {\n        if (isNumerical) {\n          return Number(a) - Number(b)\n        } else {\n          return a > b ? 1 : -1\n        }\n      })\n      .map(possibleFilterValue => {\n        return {\n          filterElementName: possibleFilterValue.toString(),\n          numMatchingRecords: searchResults.filter(result => this.fnGetTargetValue(result).includes(possibleFilterValue)).length,\n        }\n      })\n  }\n\n  public isSelected(value: FilterValue) {\n    return this._selectedValues.has(value)\n  }\n\n  public toggleValue(value: FilterValue) {\n    if (!this._possibleValues.has(value)) {\n      console.log(`invalid value toggled: ${value}`)\n      return;\n    }\n    if (this._selectedValues.has(value)) {\n      this._selectedValues.delete(value)\n    } else {\n      this._selectedValues.add(value)\n    }\n  }\n\n  public resetValue(value: FilterValue) {\n    if (!this._possibleValues.has(value)) {\n      console.log(`invalid value toggled: ${value}`)\n      return;\n    }\n    if (this._selectedValues.has(value)) {\n      this._selectedValues.delete(value)\n    }\n  }\n\n}","import { CourseModel } from \"../CourseModel\"\nimport { ProgramModel } from \"../ProgramModel\"\nimport { SpecialisationModel } from \"../SpecialisationModel\"\nimport { FilterModel } from \"./FilterModel\"\n\nexport const getCourseFilters = (allSearchData: CourseModel[]) => {\n  const filters: FilterModel<CourseModel>[] = [\n    new FilterModel<CourseModel>(\"Offering Periods\", (course) => course.termOffering),\n    new FilterModel<CourseModel>(\"Faculty\", (course) => [course.facultyName]),\n    new FilterModel<CourseModel>(\"School\", (course) => [course.schoolName]),\n    new FilterModel<CourseModel>(\"Credit Points\", (course) => [course.creditPoints.toString()]),\n  ]\n  filters.forEach(filter => filter.initializeFilter(allSearchData))\n  return filters\n}\n\nexport const getProgramFilters = (allSearchData: ProgramModel[]) => {\n  const filters: FilterModel<ProgramModel>[] = [\n    new FilterModel<ProgramModel>(\"Intake Periods\", (program) => program.intakePeriod),\n    new FilterModel<ProgramModel>(\"Faculty\", (program) => [program.facultyName]),\n    new FilterModel<ProgramModel>(\"School\", (program) => [program.schoolName]),\n    new FilterModel<ProgramModel>(\"Credit Points\", (program) => [program.creditPoints.toString()]),\n    new FilterModel<ProgramModel>(\"Academic Item Type\", (program) => [program.academicItemType]),\n  ]\n  filters.forEach(filter => filter.initializeFilter(allSearchData))\n  return filters\n}\n\nexport const getSpecialisationFilters = (allSearchData: SpecialisationModel[]) => {\n  const filters: FilterModel<SpecialisationModel>[] = [\n    new FilterModel<SpecialisationModel>(\"Faculty\", (specialisation) => [specialisation.facultyName]),\n    new FilterModel<SpecialisationModel>(\"School\", (specialisation) => [specialisation.schoolName]),\n    new FilterModel<SpecialisationModel>(\"Credit Points\", (specialisation) => [specialisation.creditPoints.toString()]),\n    new FilterModel<SpecialisationModel>(\"Academic Item Type\", (specialisation) => [specialisation.academicItemType]),\n  ]\n  filters.forEach(filter => filter.initializeFilter(allSearchData))\n  return filters\n}\n","/* May remove */\n\nexport const ResetButtonStyle = {\n  backgroundColor: \"#dcdcdc\",\n  border: \"none\",\n  color: \"black\",\n  padding: \"15px 32px\",\n  textDecoration: \"none\",\n  display: \"inline-block\",\n  fontSize: \"16px\",\n  margin: \"4px 2px\",\n  cursor: \"pointer\",\n  width: \"100%\",\n  height: \"100%\"\n}","import { Observer, observer } from \"mobx-react\"\nimport { useState } from \"react\"\nimport { Accordion, Form, Menu } from \"semantic-ui-react\"\nimport { FilterModel } from \"../../../models/Filters/FilterModel\"\n\nexport interface IFilterSectionProps<T> {\n  searchResults: T[]\n  filter: FilterModel<T>\n}\n\nexport const FilterSection = observer(<T,>(props: IFilterSectionProps<T>) => {\n  const [expandedFilters, setExpandedFilters] = useState(new Set<string>())\n\n  return <Observer>\n    {\n      () => {\n        let filterState = props.filter.getFilterState(props.searchResults)\n        return (\n            <Menu.Item key={props.filter.name}>\n              <Accordion.Title\n                active={expandedFilters.has(props.filter.name)}\n                content={props.filter.name}\n                onClick={() => {\n                  let newExpandedFilters = new Set(expandedFilters)\n                  if (expandedFilters.has(props.filter.name)) {\n                    newExpandedFilters.delete(props.filter.name)\n                  } else {\n                    newExpandedFilters.add(props.filter.name)\n                  }\n                  setExpandedFilters(newExpandedFilters)\n                }}\n              />\n              <Accordion.Content\n                active={expandedFilters.has(props.filter.name)}\n                content={\n                  <Form>\n                    <Form.Group grouped>\n                      {\n                        filterState.map(filterElementState => {\n                          return <Form.Checkbox\n                            key={filterElementState.filterElementName}\n                            label={`${filterElementState.filterElementName}`}\n                            name={props.filter.name}\n                            type=\"checkbox\"\n                            value={filterElementState.filterElementName}\n                            checked={props.filter.isSelected(filterElementState.filterElementName)}\n                            onClick={() => {\n                              props.filter.toggleValue(filterElementState.filterElementName)\n                            }}\n                          />\n                        })\n                      }\n                    </Form.Group>\n                  </Form>\n                }\n              />\n            </Menu.Item>\n        )\n      }\n    }\n  </Observer>\n})\n","import { Observer, observer } from 'mobx-react'\nimport { Accordion, Menu } from 'semantic-ui-react'\nimport { ResetButtonStyle } from '../../../config/ResetButtonStyle'\nimport { FilterModel } from '../../../models/Filters/FilterModel'\nimport { FilterSection } from './FilterSection'\nimport './ResetButton.css'\nexport interface IFilterMenuProps<T> {\n  searchResults: T[]\n  filters: FilterModel<T>[]\n}\n\nexport const FilterMenuView = observer(<T,>(props: IFilterMenuProps<T>) => {\n  const handlereset = () => {\n    props.filters.forEach((filter) => {\n      filter.getFilterState(props.searchResults).forEach((element) => {\n        filter.resetValue(element.filterElementName)\n      })\n    })\n  }\n\n  return (\n    <Observer>\n      {\n        () => {\n          return <div >\n            <div className=\"resetbutton\">\n              <button style={ResetButtonStyle} onClick={() => handlereset()}>Reset Filter</button>\n            </div>\n            <Accordion fluid as={Menu} vertical>\n              {\n                props.filters.map(filter => {\n                  return <FilterSection\n                    searchResults={props.searchResults}\n                    filter={filter}\n                  />\n                })\n              }\n            </Accordion>\n\n          </div>\n        }\n\n      }\n    </Observer>\n  )\n})\n","import { Observer, observer } from \"mobx-react\"\nimport React from \"react\"\nimport { Item } from \"semantic-ui-react\"\nimport styled from 'styled-components'\nimport { CourseModel } from \"../../../models/CourseModel\"\nimport { ResultCollection } from \"../SearchPanelStyles\"\nimport { CourseResultView } from \"./CourseResultView\"\n\nexport interface IResultCollectionViewProps<T> {\n  results: T[]\n}\n\nconst CourseCollection = styled(Item.Group)`\n  &&& {\n    padding: 15px 0px 10px 0px;\n  }\n`\n        \nexport const CourseResultCollectionView = observer((props: IResultCollectionViewProps<CourseModel>) => {\n  return <Observer>\n    {\n      () => {\n        return (\n          <ResultCollection divided>\n            {\n              props.results.map(course => {\n                return (\n                  <CourseResultView course={course} />\n                )\n              })\n            }\n          </ResultCollection>\n        )\n      }\n    }\n  </Observer>\n})\n","\nimport { observer, Observer } from \"mobx-react\"\nimport React, { useState } from \"react\"\nimport { Grid } from \"semantic-ui-react\"\nimport { FilterMenuView } from \"../Filter/FilterMenuView\"\nimport { CourseResultCollectionView } from \"../Results/CourseResultCollectionView\"\nimport { ResultsColumn, ResultsPagination } from \"../SearchPanelStyles\"\nimport { ISearchTabProps } from \"./SearchTabInterfaces\"\n\nexport const CourseSearchTab = observer((props: ISearchTabProps) => {\n  const [activePageNumber, setActivePageNumber] = useState(1)\n\n\n  return <Observer>\n    {\n      () => {\n        return (\n          <>\n            <Grid columns={12} divided container>\n              <Grid.Row>\n                <Grid.Column key=\"filter\" width={4}>\n                  <FilterMenuView\n                    searchResults={props.searchPanelViewModel.searchResults.courseSearchResults}\n                    filters={props.searchPanelViewModel.searchFilters.courseFilters}\n                  />\n                </Grid.Column>\n                <ResultsColumn key=\"results\" width={12}>\n                  <CourseResultCollectionView results={\n                    props.searchPanelViewModel.searchResults.courseSearchResults\n                      .slice(\n                        props.searchPanelViewModel.resultsPerPage * (activePageNumber - 1),\n                        Math.min(props.searchPanelViewModel.searchResults.courseSearchResults.length, props.searchPanelViewModel.resultsPerPage * activePageNumber),\n                      )\n                  } />\n                  <ResultsPagination\n                    totalPages={Math.ceil(props.searchPanelViewModel.searchResults.courseSearchResults.length / props.searchPanelViewModel.resultsPerPage)}\n                    onPageChange={(e, data) => {\n                      setActivePageNumber(Number(data.activePage))\n                      // console.log(data)\n                    }}\n                    activePage={activePageNumber}\n                  />\n                </ResultsColumn>\n              </Grid.Row>\n\n            </Grid>\n          </>\n        )\n      }\n    }\n  </Observer>\n})\n","import { Observer, observer } from \"mobx-react\"\nimport React, { useState } from \"react\"\nimport { Button, Icon, Item } from \"semantic-ui-react\"\nimport { ProgressionStatus } from \"../../../interfaces/ModelInterfaces\"\nimport { ProgramModel } from \"../../../models/ProgramModel\"\nimport { ResultItem, ResultItemContent, ResultItemExtra } from \"../SearchPanelStyles\"\n\nexport interface IResultViewProps<T> {\n  program: T\n}\n\nexport const ProgramResultView = observer((props: IResultViewProps<ProgramModel>) => {\n  const [showOptions, setShowOptions] = useState(false)\n\n  const openInNewTab = (url) => {\n    const newWindow = window.open(url, '_blank', 'noopener,noreferrer')\n    if (newWindow) newWindow.opener = null\n  }\n\n  return <Observer>\n    {\n      () => {\n        return (\n          <ResultItem\n            onMouseEnter={() => setShowOptions(true)}\n            onMouseLeave={() => setShowOptions(false)}\n          >\n            <ResultItemContent>\n              <Item.Header>{props.program.title}</Item.Header>\n              <Item.Description>{props.program.academicItemType} - {props.program.code}</Item.Description>\n            </ResultItemContent>\n            {\n              !showOptions\n                ?\n                <ResultItemContent>\n                  <ResultItemExtra>{props.program.creditPoints} UOC</ResultItemExtra>\n                  <ResultItemExtra>\n                    {\n                      props.program.progressionStatus === ProgressionStatus.PLANNED\n                        ? <Icon color=\"green\" className=\"calendar alternate outline\" />\n                        : <></>\n                    }\n                  </ResultItemExtra>\n                </ResultItemContent>\n                :\n                <ResultItemContent>\n                  <ResultItemExtra>\n                    <Button.Group>\n                      <Button\n                        basic = {props.program.progressionStatus === ProgressionStatus.UNPLANNED}\n                        icon={props.program.progressionStatus === ProgressionStatus.UNPLANNED ? \"plus circle\" : \"minus circle\"}\n                        content={props.program.progressionStatus === ProgressionStatus.UNPLANNED ? \"Add\" : \"Remove\"}\n                        color={props.program.progressionStatus === ProgressionStatus.UNPLANNED ? \"green\" : \"red\"}\n                        size=\"medium\"\n                        onClick= {() => {\n                          if (props.program.progressionStatus === ProgressionStatus.UNPLANNED) {\n                            props.program.setPlanned()\n                          } else {\n                            props.program.setUnplanned()\n                          }\n                        }}\n                      />\n                      <Button\n                        basic = {true}\n                        icon={'book'}\n                        content={'Handbook'}\n                        color={'red'}\n                        size=\"medium\"\n                        onClick= {() => openInNewTab(`https://www.handbook.unsw.edu.au${props.program.urlMap}`) }\n                      />\n                    </Button.Group>\n                  </ResultItemExtra>\n                </ResultItemContent>\n            }\n          </ResultItem>\n        )\n      }\n    }\n  </Observer>\n})\n","import { Observer, observer } from \"mobx-react\"\nimport { ProgramModel } from \"../../../models/ProgramModel\"\nimport { ProgramResultView } from \"./ProgramResultView\"\nimport { ResultCollection } from \"../SearchPanelStyles\"\n\nexport interface IResultCollectionViewProps<T> {\n  results: T[]\n}\n\nexport const ProgramResultCollectionView = observer((props: IResultCollectionViewProps<ProgramModel>) => {\n  return <Observer>\n    {\n      () => {\n        return (\n          <ResultCollection divided>\n            {\n              props.results.map(program => {\n                return (\n                  <ProgramResultView program={program} />\n                )\n              })\n            }\n          </ResultCollection>\n        )\n      }\n    }\n  </Observer>\n})\n","\nimport { observer, Observer } from \"mobx-react\"\nimport React, { useState } from \"react\"\nimport { Grid } from \"semantic-ui-react\"\nimport { FilterMenuView } from \"../Filter/FilterMenuView\"\nimport { ProgramResultCollectionView } from \"../Results/ProgramResultCollectionView\"\nimport { ResultsColumn, ResultsPagination } from \"../SearchPanelStyles\"\nimport { ISearchTabProps } from \"./SearchTabInterfaces\"\n\nexport const ProgramSearchTab = observer((props: ISearchTabProps) => {\n  const [activePageNumber, setActivePageNumber] = useState(1)\n\n\n  return <Observer>\n    {\n      () => {\n        return (\n          <>\n            <Grid columns={12} divided container>\n              <Grid.Row>\n                <Grid.Column key=\"filter\" width={4}>\n                  <FilterMenuView\n                    searchResults={props.searchPanelViewModel.searchResults.programSearchResults}\n                    filters={props.searchPanelViewModel.searchFilters.programFilters}\n                  />\n                </Grid.Column>\n                <ResultsColumn key=\"results\" width={12}>\n                  <ProgramResultCollectionView results={\n                    props.searchPanelViewModel.searchResults.programSearchResults\n                      .slice(\n                        props.searchPanelViewModel.resultsPerPage * (activePageNumber - 1),\n                        Math.min(props.searchPanelViewModel.searchResults.programSearchResults.length, props.searchPanelViewModel.resultsPerPage * activePageNumber),\n                      )\n                  } />\n                  <ResultsPagination\n                    totalPages={Math.ceil(props.searchPanelViewModel.searchResults.programSearchResults.length / props.searchPanelViewModel.resultsPerPage)}\n                    onPageChange={(e, data) => {\n                      setActivePageNumber(Number(data.activePage))\n                      // console.log(data)\n                    }}\n                    activePage={activePageNumber}\n                  />\n                </ResultsColumn>\n              </Grid.Row>\n\n            </Grid>\n          </>\n        )\n      }\n    }\n  </Observer>\n})\n","import { Observer, observer } from \"mobx-react\"\nimport { SpecialisationModel } from \"../../../models/SpecialisationModel\"\nimport { SpecialisationResultView } from \"./SpecialisationResultView\"\nimport { ResultCollection } from \"../SearchPanelStyles\"\n\nexport interface IResultCollectionViewProps<T> {\n  results: T[]\n}\n\nexport const SpecialisationResultCollectionView = observer((props: IResultCollectionViewProps<SpecialisationModel>) => {\n  return <Observer>\n    {\n      () => {\n        return (\n          <ResultCollection divided>\n            {\n              props.results.map(specialisation => {\n                return (\n                  <SpecialisationResultView specialisation={specialisation} />\n                )\n              })\n            }\n          </ResultCollection>\n        )\n      }\n    }\n  </Observer>\n})\n","\nimport { observer, Observer } from \"mobx-react\"\nimport React, { useState } from \"react\"\nimport { Grid } from \"semantic-ui-react\"\nimport { FilterMenuView } from \"../Filter/FilterMenuView\"\nimport { SpecialisationResultCollectionView } from \"../Results/SpecialisationResultCollectionView\"\nimport { ResultsColumn, ResultsPagination } from \"../SearchPanelStyles\"\nimport { ISearchTabProps } from \"./SearchTabInterfaces\"\n\nexport const SpecialisationSearchTab = observer((props: ISearchTabProps) => {\n  const [activePageNumber, setActivePageNumber] = useState(1)\n\n\n  return <Observer>\n    {\n      () => {\n        return (\n          <>\n            <Grid columns={12} divided container>\n              <Grid.Row>\n                <Grid.Column key=\"filter\" width={4}>\n                  <FilterMenuView\n                    searchResults={props.searchPanelViewModel.searchResults.specialisationSearchResults}\n                    filters={props.searchPanelViewModel.searchFilters.specialisationFilters}\n                  />\n                </Grid.Column>\n                <ResultsColumn key=\"results\" width={12}>\n                  <SpecialisationResultCollectionView results={\n                    props.searchPanelViewModel.searchResults.specialisationSearchResults\n                      .slice(\n                        props.searchPanelViewModel.resultsPerPage * (activePageNumber - 1),\n                        Math.min(props.searchPanelViewModel.searchResults.specialisationSearchResults.length, props.searchPanelViewModel.resultsPerPage * activePageNumber),\n                      )\n                  } />\n                  <ResultsPagination\n                    totalPages={Math.ceil(props.searchPanelViewModel.searchResults.specialisationSearchResults.length / props.searchPanelViewModel.resultsPerPage)}\n                    onPageChange={(e, data) => {\n                      setActivePageNumber(Number(data.activePage))\n                      // console.log(data)\n                    }}\n                    activePage={activePageNumber}\n                  />\n                </ResultsColumn>\n              </Grid.Row>\n\n            </Grid>\n          </>\n        )\n      }\n    }\n  </Observer>\n})\n","import { Observer, observer } from 'mobx-react'\nimport React from 'react'\nimport { Container, Dropdown, Icon, Input, Menu } from 'semantic-ui-react'\nimport styled from 'styled-components'\nimport { SearchPanelItem, SearchPanelViewModel } from './SearchPanelViewModel'\nimport { CourseSearchTab } from './SearchTab/CourseSearchTab'\nimport { ProgramSearchTab } from './SearchTab/ProgramSearchTab'\nimport { SpecialisationSearchTab } from './SearchTab/SpecialisationSearchTab'\n\n\nconst ResultsSubtextContainer = styled.div`\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n  padding: 6px;\n`\n\nconst FoundResults = styled.h4`\n  &&& {\n    margin: 1rem 0 0.5rem 0.5rem\n  }\n`\n\nconst SearchPanel = observer(({ searchPanelViewModel }: { [key: string]: SearchPanelViewModel }) => {\n  const getNumResults = () => {\n    let numResults = -1\n    switch (searchPanelViewModel.activeItem) {\n      case (SearchPanelItem.COURSES):\n        numResults = searchPanelViewModel.searchResults.courseSearchResults.length\n        break\n      case (SearchPanelItem.PROGRAMS):\n        numResults = searchPanelViewModel.searchResults.programSearchResults.length\n        break\n      case (SearchPanelItem.SPECIALISATIONS):\n        numResults = searchPanelViewModel.searchResults.specialisationSearchResults.length\n        break\n    }\n    return numResults\n  }\n\n  return <Observer>\n    {\n      () => {\n        return (\n          <React.Fragment>\n            <Container>\n              <Input\n                placeholder=\"Click here to to get started!\"\n                fluid\n                loading={searchPanelViewModel.isLoading}\n                icon={\n                  <Icon\n                    link={searchPanelViewModel.isInputActive}\n                    className={searchPanelViewModel.isInputActive ? \"x\" : \"search\"}\n                    onClick={() => {\n                      searchPanelViewModel.setQueryText(\"\")\n                      searchPanelViewModel.setInputActive(false)\n                    }}\n                  />\n                }\n                onClick={() => {\n                  searchPanelViewModel.setInputActive(true)\n                }}\n                onChange={(e, data) => searchPanelViewModel.setQueryText(data.value)}\n                value={searchPanelViewModel.queryText}\n              />\n              {\n                searchPanelViewModel.shouldShowPanel\n                  ? <>\n                    <Menu pointing secondary>\n                      <Menu.Item\n                        name={\"courses\"}\n                        active={searchPanelViewModel.activeItem === SearchPanelItem.COURSES}\n                        onClick={() => searchPanelViewModel.setActiveItem(SearchPanelItem.COURSES)}\n                      >\n                        {`Courses (${searchPanelViewModel.searchResults.courseSearchResults.length})`}\n                      </Menu.Item>\n                      <Menu.Item\n                        name={\"programs\"}\n                        active={searchPanelViewModel.activeItem === SearchPanelItem.PROGRAMS}\n                        onClick={() => searchPanelViewModel.setActiveItem(SearchPanelItem.PROGRAMS)}\n                      >\n                        {`Programs (${searchPanelViewModel.searchResults.programSearchResults.length})`}\n                      </Menu.Item>\n                      <Menu.Item\n                        name={\"specialisations\"}\n                        active={searchPanelViewModel.activeItem === SearchPanelItem.SPECIALISATIONS}\n                        onClick={() => searchPanelViewModel.setActiveItem(SearchPanelItem.SPECIALISATIONS)}\n                      >\n                        {`Specialisations (${searchPanelViewModel.searchResults.specialisationSearchResults.length})`}\n                      </Menu.Item>\n                    </Menu>\n                    <ResultsSubtextContainer>\n                      <FoundResults>\n                        Found {getNumResults()} result{getNumResults() === 1 ? \"\" : \"s\"}\n                      </FoundResults>\n\n                      <span>\n                        <span style={{ marginRight: \"10px\"}}>Results per page</span>\n                        <Dropdown\n                          text={searchPanelViewModel.resultsPerPage.toString()}\n                          selection\n                          options={[\n                            { text: 10, value: 10 },\n                            { text: 20, value: 20 },\n                            { text: 30, value: 30 },\n                            { text: 50, value: 50 },\n                          ]}\n                          onChange={(e, data) => { searchPanelViewModel.setResultsPerPage(Number(data.value)) }}\n                        />\n                      </span>\n                    </ResultsSubtextContainer>\n                    {\n                      searchPanelViewModel.activeItem === SearchPanelItem.COURSES\n                        ? <CourseSearchTab searchPanelViewModel={searchPanelViewModel} />\n                        : <></>\n                    }\n                    {\n                      searchPanelViewModel.activeItem === SearchPanelItem.PROGRAMS\n                        ? <ProgramSearchTab searchPanelViewModel={searchPanelViewModel} />\n                        : <></>\n                    }\n                    {\n                      searchPanelViewModel.activeItem === SearchPanelItem.SPECIALISATIONS\n                        ? <SpecialisationSearchTab searchPanelViewModel={searchPanelViewModel} />\n                        : <></>\n                    }\n                  </>\n                  : <></>\n              }\n            </Container>\n          </React.Fragment>\n        )\n      }\n    }\n  </Observer>\n\n})\n\nexport default SearchPanel\n","import styled from \"styled-components\"\nimport { AutoPlannerViewModel } from \"./AutoPlannerModel\"\n\nconst AutoPlanButton = styled.button`\n  background-color: forestgreen;\n  border: none;\n  border-radius: 4px;\n  color: white;\n  padding: 15px 32px;\n  text-decoration: none;\n  display: inline-block;\n  font-size: 16px;\n  margin: 4px 2px;\n  cursor: pointer;\n  width: 100%;\n  -webkit-user-select: none;  /* Chrome all / Safari all */\n  -moz-user-select: none;     /* Firefox all */\n  -ms-user-select: none;      /* IE 10+ */\n  user-select: none;          /* Likely future */ \n`\nconst AutoPlanner = ({ autoPlannerViewModel }: { [key: string]: AutoPlannerViewModel }) => {\n  return (\n    <AutoPlanButton onClick={() => autoPlannerViewModel.autoPlan()}>\n      Auto Plan Degree\n    </AutoPlanButton>\n  )\n};\n\nexport default AutoPlanner;","import { CourseState } from \"../../states/CourseState\";\r\nimport { CourseModel } from \"../../models/CourseModel\";\r\nimport { TermModel } from \"../../models/TermModel\";\r\n\r\nexport class AutoPlannerViewModel {\r\n    private courseState: CourseState;\r\n  \r\n    constructor(courseState: CourseState) {\r\n        this.courseState = courseState;\r\n    }\r\n\r\n    get autoPlanCourseState(): CourseState {\r\n        return this.courseState;\r\n    }\r\n\r\n    autoPlan() {\r\n        let canAllocateCourses: boolean = true;\r\n        let listYearsToTryAllocate: number[] = this.getYearsToTryAllocate(this.courseState.getMaxAllocatedYear);\r\n        let listTermsToTryAllocate: string[] = [\"Term 1\", \"Term 2\", \"Term 3\"]\r\n\r\n        while (canAllocateCourses === true) {\r\n            let coursesToBeAllocated: CourseModel[] = this.courseState.plannedCourses;\r\n            let nCoursesToAllocate: number = coursesToBeAllocated.length;\r\n            let hasChanged = false;\r\n\r\n            // Try for each year, term; if allocation spot is free & pre-req is met, add course to term\r\n            for (var counter = 0; counter < coursesToBeAllocated.length; counter++) {\r\n                let termAllocatedFlag = false;\r\n                for (let i = 0; i < listYearsToTryAllocate.length; i++) {\r\n                    if (termAllocatedFlag === false) {\r\n                        for (let j = 0; j < listTermsToTryAllocate.length; j++) {\r\n                            let canAssignToTerm : string[] | boolean = this.courseState.getMissingRequirementsWhenAssigningCourseToTerm(coursesToBeAllocated[counter], new TermModel(listYearsToTryAllocate[i], listTermsToTryAllocate[j]));\r\n                            let termHasSpaceToAllocate : boolean = this.termHasLessThanThreeCourses(listYearsToTryAllocate[i], listTermsToTryAllocate[j], this.courseState.termCourseMap);\r\n                            let termIsDisabled: boolean = new TermModel(listYearsToTryAllocate[i], listTermsToTryAllocate[j]).isBefore(new TermModel(2021, \"Term 2\"))\r\n                            if (canAssignToTerm.length === 0) {\r\n                                canAssignToTerm = true;\r\n                            } else {\r\n                                canAssignToTerm = false;\r\n                            }\r\n\r\n                            if (!termIsDisabled && termHasSpaceToAllocate && canAssignToTerm) {\r\n                                this.courseState.assignCourseToTerm(coursesToBeAllocated[counter], new TermModel(listYearsToTryAllocate[i], listTermsToTryAllocate[j]));\r\n                                termAllocatedFlag = true;\r\n                                hasChanged = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Terminating condition\r\n            // If there are no changes, this means that there are no more courses that can be allocated\r\n            // and hence terminate allocation attempt\r\n            if (hasChanged === false) {\r\n                canAllocateCourses = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    termHasLessThanThreeCourses(year: number, term: string, allocatedCourses: Map<string, CourseModel[]>) : boolean {\r\n        let dictKey = year + \"_\" + term;\r\n\r\n        if (allocatedCourses.has(dictKey)) {\r\n            // A term already has 3 courses, can't allocate\r\n            if (allocatedCourses.get(dictKey)!.length >= 3) {\r\n                return false;\r\n            }\r\n\r\n            // Term exists in allocatedTerm array, but has less than 3 courses, can allocate\r\n            return true;\r\n        } else {\r\n            // Term has not been allocated, can allocate\r\n            return true;\r\n        }\r\n    }\r\n\r\n    getYearsToTryAllocate(maxYear: number) {\r\n        var list: number[] = [];\r\n\r\n        // Return list of years with excess, incase all previous terms are full\r\n        for (var i = 2021; i <= maxYear + 4; i++) {\r\n            list.push(i);\r\n        }\r\n\r\n        return list;\r\n    }\r\n}","import \"fomantic-ui-css/semantic.min.css\";\nimport { Observer } from 'mobx-react-lite';\nimport React, { useContext } from 'react';\nimport SplitPane from 'react-split-pane';\nimport 'semantic-ui-react';\nimport { Container } from 'semantic-ui-react';\nimport './App.css';\nimport LocalImportExport from \"./containers/LocalImportExport/LocalImportExport\"\nimport { LocalImportExportViewModel } from './containers/LocalImportExport/LocalImportExportViewModel';\nimport { MenuBar } from './containers/MenuBar/MenuBar';\nimport Planner from './containers/Planner/Planner';\nimport { PlannerViewModel } from './containers/Planner/PlannerViewModel';\nimport ProgressionPlanner from './containers/ProgressionPlanner/ProgressionPlanner';\nimport { ProgressionPlannerViewModel } from './containers/ProgressionPlanner/ProgressionPlannerViewModel';\nimport SearchPanel from './containers/SearchPanel/SearchPanel';\nimport { SearchPanelViewModel } from './containers/SearchPanel/SearchPanelViewModel';\nimport { ApplicationContext } from './contexts/ApplicationContext';\nimport AutoPlanner from './containers/AutoPlan/AutoPlannerView';\nimport { AutoPlannerViewModel } from \"./containers/AutoPlan/AutoPlannerModel\";\n\nconst App = () => {\n  const applicationContext = useContext(ApplicationContext)\n\n  const searchPanelViewModel = new SearchPanelViewModel(applicationContext.searchDataState);\n  const plannerViewModel = new PlannerViewModel(applicationContext.courseState);\n  const progressionPlannerViewModel = new ProgressionPlannerViewModel(applicationContext.progressionState, applicationContext.courseState);\n  const localImportExportModel = new LocalImportExportViewModel(applicationContext.userState, applicationContext.progressionState, applicationContext.courseState);\n  const autoPlannerViewModel = new AutoPlannerViewModel(applicationContext.courseState);\n\n  return (\n    <ApplicationContext.Provider value={applicationContext}>\n      <div className=\"ui maincontainer\">\n        <MenuBar userState={applicationContext.userState} />\n        <SplitPane\n          className=\"split-pane-flex\"\n          split=\"vertical\"\n          defaultSize={\"min(50vw, 1000px)\"}\n          primary=\"second\"\n        >\n          <Container style={{ padding: 10 }} fluid>\n            <SearchPanel searchPanelViewModel={searchPanelViewModel} />\n            <Observer>\n              {\n                () => {\n                  return (\n                    !searchPanelViewModel.shouldShowPanel\n                      ? <ProgressionPlanner progressionPlannerViewModel={progressionPlannerViewModel} />\n                      : <></>\n                  )\n                }\n              }\n            </Observer>\n          </Container>\n          <Container style={{ padding: 10, paddingLeft: 50 }} fluid>\n            <LocalImportExport localImportExportViewModel={localImportExportModel} />\n            <AutoPlanner autoPlannerViewModel={autoPlannerViewModel} />\n            <Planner plannerViewModel={plannerViewModel} />\n          </Container>\n        </SplitPane>\n      </div>\n    </ApplicationContext.Provider>\n  )\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}